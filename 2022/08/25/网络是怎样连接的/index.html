

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="协议栈网络控制软件。 网卡将包转换为电信号并通过网线发送出去。 wwwwww只是Web服务器上的一种命名。 World Wide Web不是一个协议的名字，而是Web的提出者最早开发的浏览器兼HTML编辑器的名字 URL格式其用户名，密码，端口号可省略。  默认文件。 CGICommon Gateway Interface公共网关接口. HTTP谓词也叫HTTP动词，方法。 设置网卡是会设置DNS">
<meta property="og:type" content="article">
<meta property="og:title" content="网络是怎样连接的">
<meta property="og:url" content="http://example.com/2022/08/25/%E7%BD%91%E7%BB%9C%E6%98%AF%E6%80%8E%E6%A0%B7%E8%BF%9E%E6%8E%A5%E7%9A%84/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="协议栈网络控制软件。 网卡将包转换为电信号并通过网线发送出去。 wwwwww只是Web服务器上的一种命名。 World Wide Web不是一个协议的名字，而是Web的提出者最早开发的浏览器兼HTML编辑器的名字 URL格式其用户名，密码，端口号可省略。  默认文件。 CGICommon Gateway Interface公共网关接口. HTTP谓词也叫HTTP动词，方法。 设置网卡是会设置DNS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/media/16511291377041.png">
<meta property="og:image" content="http://example.com/media/16516425247159.png">
<meta property="og:image" content="http://example.com/media/16516477115302.png">
<meta property="og:image" content="http://example.com/media/16517249101641.png">
<meta property="og:image" content="http://example.com/media/16517943441373.png">
<meta property="og:image" content="http://example.com/media/16517952103552.png">
<meta property="og:image" content="http://example.com/media/16521403771184.png">
<meta property="og:image" content="http://example.com/media/16523998935740.png">
<meta property="og:image" content="http://example.com/media/16524182951589.png">
<meta property="og:image" content="http://example.com/media/16524182951170.png">
<meta property="article:published_time" content="2022-08-25T02:17:54.000Z">
<meta property="article:modified_time" content="2022-09-08T09:22:32.024Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/media/16511291377041.png">
  
  
  
  <title>网络是怎样连接的 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Jie</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/SteinsGate_all.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="网络是怎样连接的"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-25 10:17" pubdate>
          2022年8月25日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          72 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">网络是怎样连接的</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="协议栈"><a href="#协议栈" class="headerlink" title="协议栈"></a>协议栈</h2><p>网络控制软件。</p>
<h2 id="网卡"><a href="#网卡" class="headerlink" title="网卡"></a>网卡</h2><p>将包转换为电信号并通过网线发送出去。</p>
<h2 id="www"><a href="#www" class="headerlink" title="www"></a>www</h2><p>www只是Web服务器上的一种命名。</p>
<p>World Wide Web不是一个协议的名字，而是Web的提出者最早开发的浏览器兼HTML编辑器的名字</p>
<h2 id="URL格式"><a href="#URL格式" class="headerlink" title="URL格式"></a>URL格式</h2><p>其用户名，密码，端口号可省略。</p>
<p><img src="/media/16511291377041.png" srcset="/img/loading.gif" lazyload></p>
<p>默认文件。</p>
<h2 id="CGI"><a href="#CGI" class="headerlink" title="CGI"></a>CGI</h2><p>Common Gateway Interface公共网关接口.</p>
<h2 id="HTTP谓词"><a href="#HTTP谓词" class="headerlink" title="HTTP谓词"></a>HTTP谓词</h2><p>也叫HTTP动词，方法。</p>
<p>设置网卡是会设置DNS地址，就是DNS服务器的IP地址。</p>
<p>GET方法能够发送的数据只有几百个字节，如果表单中的数据超过这一长度，则必须使用POST方法来发送。</p>
<h2 id="请求消息"><a href="#请求消息" class="headerlink" title="请求消息"></a>请求消息</h2><p>格式：</p>
<ul>
<li>请求行，可大致了解请求内容</li>
<li>消息头，附加信息</li>
<li>消息体，数据</li>
</ul>
<p>消息头之后会有一个空行。</p>
<p>使用GET方法时，消息体中不需要数据。</p>
<p>使用POST方法时，需要将表单中填写的信息写在消息体中。</p>
<h2 id="响应消息"><a href="#响应消息" class="headerlink" title="响应消息"></a>响应消息</h2><p>第一行为状态码和响应短语。</p>
<h2 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h2><p>每个URI标识一个文件。</p>
<p>每条请求消息中只能写一个URI，所以每次请求只能获取一个文件。</p>
<h2 id="域名和IP"><a href="#域名和IP" class="headerlink" title="域名和IP"></a>域名和IP</h2><p>直接用IP地址来代替服务器名称也能正常工作，但如果Web服务器使用了虚拟主机功能，就可能无法通过IP地址来访问。</p>
<p>域名便于记忆。<br>IP地址便于传输。</p>
<h2 id="操作系统的Socket库"><a href="#操作系统的Socket库" class="headerlink" title="操作系统的Socket库"></a>操作系统的Socket库</h2><p>含DNS解析器。</p>
<p>库，一堆通用程序组建的集合。</p>
<p>几个函数：</p>
<ul>
<li>socket，创建套接字。</li>
<li>connect，客户端套接字与服务端连接。三个参数，描述符，服务器IP地址和端口号。</li>
<li>write，两个参数，描述符和发送数据。</li>
<li>read，需指定接收缓冲区。</li>
<li>close，删除套接字。</li>
</ul>
<h2 id="DNS服务器"><a href="#DNS服务器" class="headerlink" title="DNS服务器"></a>DNS服务器</h2><p>基本工作，接收来自客户端的查询消息，然后根据消息的内容返回响应。</p>
<p>MX，mail exchange.</p>
<p>记录类型，A—address，对应IP地址。<br>MX，对应邮件服务器。</p>
<p>DNS服务器分层。<br>创建子域。</p>
<p>子域的DNS服务器的IP地址注册到上级DNS 服务器中。</p>
<p>DNS服务器并不会转发请求，只会直接将下一台DNS服务器的IP告诉我们，然后我们再去发起请求。</p>
<p>从根服务器开始查询。</p>
<p>DNS服务器有缓存功能，可以记住之前查询过的域名。<br>缓存信息有一个有效期。</p>
<h2 id="套接字"><a href="#套接字" class="headerlink" title="套接字"></a>套接字</h2><p>socket，传输层连接通信的通信端点。</p>
<p>服务器一般会在启动后就创建好套接字并等待客户端连接管道。</p>
<p>断开可以由服务端和客户端任意一方发起。</p>
<p>断开后，套接字会被删除。</p>
<p>创建套接字后会返回描述符。</p>
<p>几个阶段：</p>
<ul>
<li>创建套接字</li>
<li>连接Web服务器</li>
<li>发送数据</li>
<li>接收数据</li>
<li>断开连接，删除套接字</li>
</ul>
<p>其实质是一块内存空间，记录了用于控制通信操作的控制信息。</p>
<p>协议栈是根据套接字中记录的控制信息来工作的。</p>
<p>套接字的创建：</p>
<ul>
<li>分配内存空间</li>
<li>在控制信息的state列中写入listening</li>
<li>分配数据包的缓存空间</li>
</ul>
<h2 id="连接服务器"><a href="#连接服务器" class="headerlink" title="连接服务器"></a>连接服务器</h2><p>连接实际上是通信双方交换控制信息(用来控制数据收发操作所需的一些信息)，将必要信息记录在套接字并准备数据收发的操作。</p>
<p>可以看作为“准备”。</p>
<p>有以下内容：</p>
<ul>
<li>把服务器的IP地址和端口号告知协议栈</li>
<li>客户端向服务器传达开始通信的请求</li>
</ul>
<p>过程</p>
<ul>
<li>客户端syn</li>
<li>服务端syn，ack</li>
<li>客户端ack</li>
</ul>
<h2 id="Web和电子邮件的端口号"><a href="#Web和电子邮件的端口号" class="headerlink" title="Web和电子邮件的端口号"></a>Web和电子邮件的端口号</h2><p>Web—-80<br>电子邮件—-25</p>
<h2 id="HTTP工作流程"><a href="#HTTP工作流程" class="headerlink" title="HTTP工作流程"></a>HTTP工作流程</h2><ul>
<li>连接</li>
<li>发送请求消息</li>
<li>接收响应消息</li>
<li>断开</li>
</ul>
<h2 id="解析器"><a href="#解析器" class="headerlink" title="解析器"></a>解析器</h2><p>Resolver，将域名转换为IP地址。</p>
<h2 id="TCP和UDP"><a href="#TCP和UDP" class="headerlink" title="TCP和UDP"></a>TCP和UDP</h2><p>浏览器、邮件等一般应用程序收发数据时用TCP。</p>
<p>DNS查询等收发较短的控制数据时用UDP。</p>
<h2 id="PID"><a href="#PID" class="headerlink" title="PID"></a>PID</h2><p>Process IDentifier，进程标识符。</p>
<h2 id="通信中的控制信息"><a href="#通信中的控制信息" class="headerlink" title="通信中的控制信息"></a>通信中的控制信息</h2><ul>
<li><p>头部信息<br>指明传送的对象和发送的信息。</p>
</li>
<li><p>套接字中记录的信息</p>
</li>
</ul>
<h2 id="SYN"><a href="#SYN" class="headerlink" title="SYN"></a>SYN</h2><p>Synchronise Sequence Numbers，同步序列编号。</p>
<p>用于表示连接状态</p>
<p>ACK用于表示消息的接收状态。<br>ACK序号是一个随机值。<br>ack序号在交互过程中会改变。</p>
<h2 id="收发数据"><a href="#收发数据" class="headerlink" title="收发数据"></a>收发数据</h2><p>协议栈并不是一收到数据就发送出去，而是会存放在内部的发送缓存区。</p>
<p>两个判断要素：</p>
<ul>
<li>长度，MSS</li>
<li>时间</li>
</ul>
<p>或应用程序指定。</p>
<p>发送过的包会保存在发送缓冲区中。<br>因此，网卡、集线器、路由器都没有错误补偿机制。</p>
<h3 id="梳理"><a href="#梳理" class="headerlink" title="梳理"></a>梳理</h3><p>两种情况：</p>
<ul>
<li>客户端向服务器发送消息</li>
<li>服务器向客户端发送消息</li>
</ul>
<p>两者可同时进行。<br>以客户端向服务端发送为例：</p>
<ul>
<li>应用程序将数据传送给协议栈</li>
<li>数据进入协议栈内部的发送缓冲区，积累到一定量后发送或等待一段时间后发送</li>
<li>发送缓冲区的数据被以MSS长度为单位拆分，并计算数据长度放入头部，之后放入单独的网络包，标记上TCP头部，并根据套接字上的信息标记发送方和接收方的端口号。最后将数据包传给IP模块。</li>
<li>IP模块发送数据包。并将发送过的包包存在发送缓存区中。</li>
<li>服务器接收数据后计算ACK号并返回</li>
</ul>
<p>ACK号和序号初始值相关。<br>TCP会动态设置ACK号的等待时间。</p>
<h3 id="MTU"><a href="#MTU" class="headerlink" title="MTU"></a>MTU</h3><p>Maximum Transmission Unit，表示一个网络包的最大长度。其是包含头部的长度。</p>
<h3 id="MSS"><a href="#MSS" class="headerlink" title="MSS"></a>MSS</h3><p>Maximum Segment Size，最大分段大小。去除头部的大小。</p>
<p>数据会以MSS的大小拆分。</p>
<h3 id="SFD"><a href="#SFD" class="headerlink" title="SFD"></a>SFD</h3><p>Start Frame Delimiter，起始帧分界符。</p>
<h3 id="FCS"><a href="#FCS" class="headerlink" title="FCS"></a>FCS</h3><p>Frame Check Sequence，帧校验序列</p>
<h2 id="滑动窗口"><a href="#滑动窗口" class="headerlink" title="滑动窗口"></a>滑动窗口</h2><p>为了防止接收缓冲区溢出。</p>
<p>窗口大小代表了缓冲区大小。</p>
<p>窗口的大小是动态变化的。更新时机，当接收方将数据传递给应用程序时(此时接收缓冲区会变大)。</p>
<p>ACK号可合并，比如要返回两个ACK号，201～400和401～600，此时可合并为一个201～600。</p>
<p>在返回ACK号时若更新了窗口大小，则可将这两个信息一起返回。</p>
<h2 id="IP包的收发"><a href="#IP包的收发" class="headerlink" title="IP包的收发"></a>IP包的收发</h2><p>发送方和接收方统称为终端节点，转发设备被称为转发节点或者中间节点。</p>
<p>TCP模块将包传递给IP模块时，需指定通信对象的IP地址。</p>
<p>IP模块添加两个头部：</p>
<ul>
<li>MAC头部，包含MAC地址，用于将包传输至最近的路由器的控制信息。</li>
<li>IP头部，将包发往目的地的控制信息。</li>
</ul>
<p>IP地址的最初来源是应用程序，应用程序交给TCP模块，TCP模块传递给IP模块。</p>
<p>IP地址实际上是分配给网卡的。</p>
<p>协议号。</p>
<p>MAC头中写的MAC地址在传输过程中会改变。</p>
<p>以太类型就是使用的协议类型。</p>
<h3 id="ARP表"><a href="#ARP表" class="headerlink" title="ARP表"></a>ARP表</h3><p>查询目标路由器的MAC地址。</p>
<p>可能发生的通讯异常，当IP地址改变时，ARP缓存表中的值并未改变。</p>
<h3 id="以太网"><a href="#以太网" class="headerlink" title="以太网"></a>以太网</h3><p>一种以多台计算机能彼此自由和廉价地通信而设计的通信技术。</p>
<p>最开始，以太网中一个设备发送信号，其他设备都会接收到。</p>
<p>三个未改变的基本性质：</p>
<ul>
<li>包发送到MAC头部中的接收方的MAC地址，即目的地。</li>
<li>用MAC头部中的发送方的MAC地址识别发送方。</li>
<li>用以太类型识别包的内容。</li>
</ul>
<p>以太类型就是协议类型。</p>
<h2 id="网卡-1"><a href="#网卡-1" class="headerlink" title="网卡"></a>网卡</h2><p>结构：</p>
<p><img src="/media/16516425247159.png" srcset="/img/loading.gif" lazyload></p>
<p>硬件设备都有驱动程序。</p>
<p>网卡驱动程序也是厂商开发的专用程序。</p>
<p>硬件在工作前要初始化。</p>
<p>网卡的ROM中保存着唯一的MAC地址。在生产时写入。</p>
<p>网卡驱动进行初始化时在MAC模块中设置MAC地址。</p>
<h3 id="报头和报尾"><a href="#报头和报尾" class="headerlink" title="报头和报尾"></a>报头和报尾</h3><p>MAC模块会在包开头加上报头和起始帧分界符(长56比特)，最后两位为11.</p>
<p>在末尾加上用于检测错误的帧校验序列(长32比特)。</p>
<h3 id="时钟信号的作用"><a href="#时钟信号的作用" class="headerlink" title="时钟信号的作用"></a>时钟信号的作用</h3><p>时钟信号，用于判断出比特之间的界限。哪一截是一比特，由时钟信号判断。</p>
<p>可以决定是在上升沿或下降沿读取电压和电流信号。</p>
<p>解决时钟偏移的问题，发送的信号为数据信号和时钟信号的叠加。</p>
<h3 id="报头的作用"><a href="#报头的作用" class="headerlink" title="报头的作用"></a>报头的作用</h3><p>用于测量时钟信号。</p>
<h2 id="发送方式"><a href="#发送方式" class="headerlink" title="发送方式"></a>发送方式</h2><ul>
<li>集线器的半双工模式，即同一时刻只能进行发送和接收中的一种。</li>
<li>全双工模式，同一时刻发送和接收能同时进行。</li>
</ul>
<h3 id="网络的传输速率"><a href="#网络的传输速率" class="headerlink" title="网络的传输速率"></a>网络的传输速率</h3><p>即数字信息转换为电信号的速率。</p>
<h3 id="MAU模块"><a href="#MAU模块" class="headerlink" title="MAU模块"></a>MAU模块</h3><p>将MAC模块生成的通用信号转换成可在网线中传输的格式，并通过网线发送出去。</p>
<p>还具监听作用。</p>
<p>信号碰撞。</p>
<h3 id="中断"><a href="#中断" class="headerlink" title="中断"></a>中断</h3><p>一种电信号，由硬件产生，并直接送到中断控制器上，然后再由中断控制器向CPU发送信号，CPU检测到信号后，就会中断当前的工作转而去处理中断。</p>
<p>就是让CPU停下(挂起)当前的程序，而运行中断处理的程序。</p>
<p>在这里，形象的说中断就是“敲门”这个动作。</p>
<h3 id="主要的ICMP消息"><a href="#主要的ICMP消息" class="headerlink" title="主要的ICMP消息"></a>主要的ICMP消息</h3><p><img src="/media/16516477115302.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="接收服务器响应"><a href="#接收服务器响应" class="headerlink" title="接收服务器响应"></a>接收服务器响应</h2><p>分片重组。</p>
<p>套接字工作。</p>
<h2 id="UDP协议的收发操作"><a href="#UDP协议的收发操作" class="headerlink" title="UDP协议的收发操作"></a>UDP协议的收发操作</h2><p>向DNS服务器查询IP的时候使用的是UDP协议。</p>
<p>音频和视频数据使用UDP发送</p>
<h2 id="信号在网线和集线器中传输"><a href="#信号在网线和集线器中传输" class="headerlink" title="信号在网线和集线器中传输"></a>信号在网线和集线器中传输</h2><p>现在的家用路由器已集成了集线器和交换机的功能。</p>
<p>电信号的频率越高，能量的损失率越大。</p>
<h3 id="双绞线"><a href="#双绞线" class="headerlink" title="双绞线"></a>双绞线</h3><p>双绞线，抑制噪声。</p>
<p>分正负两条网线。</p>
<p>电磁波接触金属等导体，会在其中产生电流，因此，若网线周围有电磁波，就会产生和原本的信号不同的电流。</p>
<p>噪声分内源性噪声和外源性噪声。</p>
<h3 id="集线器"><a href="#集线器" class="headerlink" title="集线器"></a>集线器</h3><p>将信号广播。</p>
<h4 id="MDI-x2F-MDI-X切换开关"><a href="#MDI-x2F-MDI-X切换开关" class="headerlink" title="MDI&#x2F;MDI-X切换开关"></a>MDI&#x2F;MDI-X切换开关</h4><p>Media Dependent Interface，媒体相关接口，直连接线，用于集线器之间连接。</p>
<p>Media Dependent Interface- Crossover。交叉接线，用于集线器和设备之间连接。</p>
<p>直连接线就是“发送线路”连“发送线路”，“接收线路”连“接收线路”。</p>
<p>交叉接线是“发送线路”接“接收线路”，反之亦然。</p>
<h3 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h3><p>几乎都有的结构，内存、MAC模块和PHY模块。</p>
<p>几乎都有的操作，将输入的电信号转换为数字信号，然后将数字信号转换为电信号发送出去。</p>
<p>交换机端口的MAC模块不具有MAC地址。</p>
<p>交换机中登记的MAC地址和端口对应。</p>
<h4 id="交换电路"><a href="#交换电路" class="headerlink" title="交换电路"></a>交换电路</h4><p>交换机由交换电路而来。</p>
<p>交换电路交叉点处的交换开关为电子开关。</p>
<p>其地址表会自行更新或删除。</p>
<p>若没有接收方的端口，则广播到所有的端口。</p>
<p>接收设备接收到包后会返回响应，这样交换机就可以记录。</p>
<h4 id="全双工模式"><a href="#全双工模式" class="headerlink" title="全双工模式"></a>全双工模式</h4><p>交换机特有。</p>
<p>不使用集线器，就可以避免信号碰撞。</p>
<p>工作模式。</p>
<h4 id="连接脉冲"><a href="#连接脉冲" class="headerlink" title="连接脉冲"></a>连接脉冲</h4><p>在以太网中没有数据传输时，填充的脉冲信号。</p>
<p>检测对方网线是否正确连接。</p>
<p>通过特殊的脉冲序列。<br>也可以用于交换连接双方的状态信息，如支持的工作模式和传输速率。</p>
<h3 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h3><p>交换机是基于以太网设置的，路由器是基于IP设计的。</p>
<p>路由器的各个端口都具有MAC地址和IP地址。</p>
<h4 id="路由表"><a href="#路由表" class="headerlink" title="路由表"></a>路由表</h4><p>路由表匹配时，只匹配网络号部分。</p>
<p><img src="/media/16517249101641.png" srcset="/img/loading.gif" lazyload></p>
<h5 id="路由聚合"><a href="#路由聚合" class="headerlink" title="路由聚合"></a>路由聚合</h5><p>将路由表中多个子网合并为一个子网。</p>
<h5 id="子网掩码列"><a href="#子网掩码列" class="headerlink" title="子网掩码列"></a>子网掩码列</h5><p>表示匹配时需要对比的比特数量。</p>
<h5 id="跃点计数"><a href="#跃点计数" class="headerlink" title="跃点计数"></a>跃点计数</h5><p>表示距离目标IP地址的远近。</p>
<h5 id="路由表维护"><a href="#路由表维护" class="headerlink" title="路由表维护"></a>路由表维护</h5><ul>
<li>手动维护</li>
<li>路由器之间信息交换</li>
</ul>
<h4 id="路由器接收包"><a href="#路由器接收包" class="headerlink" title="路由器接收包"></a>路由器接收包</h4><p>路由器的一个接口相当于一个网卡。</p>
<p>选择，子网掩码长，跃点少。</p>
<p>接收之后MAC头部会被丢弃。</p>
<h5 id="默认路由"><a href="#默认路由" class="headerlink" title="默认路由"></a>默认路由</h5><p>子网掩码为0.0.0.0，为互联网接入路由器，当路由表中没有匹配到时转发到这里，这里配置的网关地址也叫默认网关。</p>
<h5 id="更新TTL"><a href="#更新TTL" class="headerlink" title="更新TTL"></a>更新TTL</h5><p>每经过一个路由器转发，TTL(Time To Live)的值就会减一，为零时被丢弃。</p>
<h5 id="分片处理"><a href="#分片处理" class="headerlink" title="分片处理"></a>分片处理</h5><p>TCP的拆分，将数据分为包，IP的分片，将包再拆分，此时考虑MTU。</p>
<p>两种情况不分片：</p>
<ul>
<li>应用程序设置不允许分片</li>
<li>包已经被分片</li>
</ul>
<h4 id="路由器发送包"><a href="#路由器发送包" class="headerlink" title="路由器发送包"></a>路由器发送包</h4><p>规则取决于端口的类型。</p>
<p>重新添加MAC头部。</p>
<p>ARP，通过IP查MAC。</p>
<h4 id="路由器与交换机之间的关系"><a href="#路由器与交换机之间的关系" class="headerlink" title="路由器与交换机之间的关系"></a>路由器与交换机之间的关系</h4><p>就是IP与以太网之间的关系路由器将包的传输工作交给交换机进行。</p>
<h4 id="IP不负责包的传送"><a href="#IP不负责包的传送" class="headerlink" title="IP不负责包的传送"></a>IP不负责包的传送</h4><p>只是委托各种通信技术将包传输到下一个路由器。</p>
<h4 id="路由器的附加功能"><a href="#路由器的附加功能" class="headerlink" title="路由器的附加功能"></a>路由器的附加功能</h4><p>主要是两个：</p>
<ul>
<li>地址过滤</li>
<li>包过滤</li>
</ul>
<h5 id="内网"><a href="#内网" class="headerlink" title="内网"></a>内网</h5><p>内网和外网。</p>
<p>内网的设立，解决地址不足的问题。</p>
<p>内网与内网之间是相互独立的,但不是完全独立。</p>
<p>内网的网络包只在内网之间流动。</p>
<p>作用于内网的地址叫私有地址(Globally Unique Address),原来的固定地址叫共有地址(Public Address)</p>
<p>私有地址范围：</p>
<ul>
<li>10.0.0.0~10.255.255.255</li>
<li>172.16.0.0~172.31.255.255</li>
<li>192.168.0.0~192.168.255.255</li>
</ul>
<p>内网分两部分：</p>
<ul>
<li>对互联网开放的服务器。分配公有地址，可以和互联网直接通信。</li>
<li>公司内部设备。分配私有地址，不能和互联网直接收发网络包。</li>
</ul>
<p>地址转换机制，基本原理，在转发网络包时修改IP头部中的IP地址和端口号。</p>
<p>家庭网络中的过程也相同。</p>
<p>改写端口号，从空闲的端口中随机选择。</p>
<p>除非公司允许，无法从互联网向公司内网发送网络包，(对应表中无记录)具备防止非法入侵的效果。</p>
<p>可以将服务器的私有地址手动配置在地址转换设备中，就可以从互联网访问这个服务器了。</p>
<h5 id="包过滤"><a href="#包过滤" class="headerlink" title="包过滤"></a>包过滤</h5><p>路由器在对包进行转换时，根据MAC地址、IP地址、TCP头部的内容，按照事先设置好的规则决定是转发还是丢弃这个包。</p>
<p>防火墙设备或软件，大多利用这一机制。</p>
<h4 id="hub解析"><a href="#hub解析" class="headerlink" title="hub解析"></a>hub解析</h4><p>hub，轴。</p>
<p>现实可想象为，自行车轮，辐条从车轮边缘一直汇聚到轴处。</p>
<p>网络可想象为，网线聚集的地方。</p>
<p>小型廉价的普及型产品一般叫交换机，大型的高性能产品一般叫二层交换机。</p>
<h2 id="光纤接入网"><a href="#光纤接入网" class="headerlink" title="光纤接入网"></a>光纤接入网</h2><p>FTTH，Fiber To The Home，</p>
<h2 id="ADSL"><a href="#ADSL" class="headerlink" title="ADSL"></a>ADSL</h2><p>Asymmetric Digital Subscriber Line,不对称数字用户线，一种利用架设在电线杆上的金属电话线来进行高速通信的技术。</p>
<p>它的上行方向(用户到互联网)和下行方向(互联网到用户)的通信速率是不对称的。</p>
<p>双绞线的极限距离是100米，光纤可达几公里。</p>
<hr>
<p>互联网中网络间的距离和路由的维护方式和家庭、公司不同。</p>
<h2 id="Modem"><a href="#Modem" class="headerlink" title="Modem"></a>Modem</h2><p>调制解调器。</p>
<p>Modulator(调制器)和Demodulator(解调器)的简称。</p>
<p>调制，modulate，即把数字信号转换成电话线上传输的模拟信号。</p>
<p>解调，demodulate，把模拟信号转换成数字信号。</p>
<h2 id="BAS"><a href="#BAS" class="headerlink" title="BAS"></a>BAS</h2><p>Broadband Access Server.宽带接入服务器，是一种路由器。</p>
<h2 id="PPP"><a href="#PPP" class="headerlink" title="PPP"></a>PPP</h2><p>Point-to-Point Protocol,点到点协议。</p>
<p>三个头部，MAC头部、PPPoE头部、PPP头部。</p>
<h2 id="ADSL-Modem-对包的拆分"><a href="#ADSL-Modem-对包的拆分" class="headerlink" title="ADSL Modem 对包的拆分"></a>ADSL Modem 对包的拆分</h2><p>拆分为很多小格子，称信元。</p>
<p>信元是小数据块，包含5字节头部和48字节数据，用于ATM(Asynchronous Transfer Mode)异步传输</p>
<h3 id="ADSL-Modem对信号的调制"><a href="#ADSL-Modem对信号的调制" class="headerlink" title="ADSL Modem对信号的调制"></a>ADSL Modem对信号的调制</h3><p>不用方波的原因：</p>
<ul>
<li>波形易失真</li>
<li>难以控制噪声</li>
</ul>
<p>调制为正弦波。<br>振幅调制ASK，相位调制PSK组成正交振幅调制QAM。</p>
<p><img src="/media/16517943441373.png" srcset="/img/loading.gif" lazyload></p>
<p>其将信元转换为电信号。</p>
<p>分离器，将电话信号和ADSL信号分离。</p>
<p>IDF(Intermediate Distribution Frame)中间配线盘，MDF(Main Distribution Frame)主配线盘。</p>
<p>保安器，防止雷电等情况下电话线中产生过大电流的一种保护装置，内部有保险丝。</p>
<h3 id="信号线"><a href="#信号线" class="headerlink" title="信号线"></a>信号线</h3><p>直径不同，信号衰减率等待性不同。</p>
<p>线越细衰减率越高。<br><img src="/media/16517952103552.png" srcset="/img/loading.gif" lazyload></p>
<p>电缆隧道，地下电缆。</p>
<h3 id="ISDN"><a href="#ISDN" class="headerlink" title="ISDN"></a>ISDN</h3><p>Integrated Services Digital Network，综合业务数字网。</p>
<h3 id="DSLAM"><a href="#DSLAM" class="headerlink" title="DSLAM"></a>DSLAM</h3><h3 id="POP和NOC"><a href="#POP和NOC" class="headerlink" title="POP和NOC"></a>POP和NOC</h3><p>都位于一个运营商中。</p>
<p>POP，Point Of Presense, 接入点。其本质是各种类型的路由器，取决于接入类型，还有交换机。</p>
<p>POP处的路由器需大量端口，其速率低于核心网络。</p>
<p>NOC，Network Operation Center, 网络运行中心，集中POP传来的包，可从这里转发至离目的地更近的POP或转发至其他运营商。 </p>
<p>NOC和PO没有严格的界定。可以认为NOC是规模扩大的POP。</p>
<h3 id="光纤铺设"><a href="#光纤铺设" class="headerlink" title="光纤铺设"></a>光纤铺设</h3><p>地下。</p>
<p>光纤可以复用。<br><img src="/media/16521403771184.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="运营商之间的路由交换"><a href="#运营商之间的路由交换" class="headerlink" title="运营商之间的路由交换"></a>运营商之间的路由交换</h3><p>相连的路由器告知路由信息。</p>
<p>转接，对等。</p>
<p>公司内部可采用最短路由。</p>
<p>运营商之间的路由交换需进行筛选。</p>
<h3 id="BGP协议"><a href="#BGP协议" class="headerlink" title="BGP协议"></a>BGP协议</h3><p>Border Gateway Protocol.</p>
<h3 id="IX"><a href="#IX" class="headerlink" title="IX"></a>IX</h3><p>Internet eXchange,互联网交换中心。运营商线路的中心，相当于是集运营商之间一对一连接的线。</p>
<p>IX的核心是具有大量高速的以太网端口的二层交换机(基本原理和一层交换机相同)。</p>
<h3 id="服务器和路由器"><a href="#服务器和路由器" class="headerlink" title="服务器和路由器"></a>服务器和路由器</h3><p>计算机都能完成路由器的工作，只要有相应的软件，一般路由器上安装的就是Linux操作系统。</p>
<h1 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h1><h2 id="防火墙原理"><a href="#防火墙原理" class="headerlink" title="防火墙原理"></a>防火墙原理</h2><p>firewall。</p>
<p>根据MAC地址，IP头部，TCP头部的内容，来决定是转发还是丢弃。</p>
<p>只允许指定应用程序的网络包发送。</p>
<h3 id="包过滤-1"><a href="#包过滤-1" class="headerlink" title="包过滤"></a>包过滤</h3><p>通过接收方IP地址、发送方IP地址、接收方端口号、发送方端口号、TCP控制位这些条件，判断出通信的起点和终点、应用程序种类。</p>
<h4 id="TCP连接时的三个包的控制位"><a href="#TCP连接时的三个包的控制位" class="headerlink" title="TCP连接时的三个包的控制位"></a>TCP连接时的三个包的控制位</h4><p>第一个包，SYN为1，ACK为0.</p>
<p>用于阻止Web服务器为起点访问互联网。</p>
<h4 id="无法阻止对DNS服务器的访问"><a href="#无法阻止对DNS服务器的访问" class="headerlink" title="无法阻止对DNS服务器的访问"></a>无法阻止对DNS服务器的访问</h4><p>使用UDP协议的都会有这样的问题。</p>
<p>只能二选一，要么允许该应用程序的所有包通过，要么阻止。</p>
<h4 id="通过防火墙"><a href="#通过防火墙" class="headerlink" title="通过防火墙"></a>通过防火墙</h4><p>被阻止的包会被丢弃并记录下来。</p>
<p>若允许通过，则转发。</p>
<h4 id="防火墙无法抵御的攻击"><a href="#防火墙无法抵御的攻击" class="headerlink" title="防火墙无法抵御的攻击"></a>防火墙无法抵御的攻击</h4><p>需要检查内容的攻击。</p>
<p>防火墙无法检查包的内容。</p>
<p>方法，部署用来检查内容的设备或软件。</p>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>多台服务器分担负载，这种架构称分布式架构。</p>
<h4 id="轮询分配"><a href="#轮询分配" class="headerlink" title="轮询分配"></a>轮询分配</h4><p>通过轮询(round-robin)的方式将访问平均分配给所有服务器</p>
<p>通过DNS服务器来实现。</p>
<p>通过DNS服务器查询服务器名称时，其返回多个IP地址。</p>
<h4 id="负载均衡器"><a href="#负载均衡器" class="headerlink" title="负载均衡器"></a>负载均衡器</h4><p>负载均衡的作用是分流，而难点在于判断什么时候不分流。</p>
<h4 id="判断请求相关性的信息"><a href="#判断请求相关性的信息" class="headerlink" title="判断请求相关性的信息"></a>判断请求相关性的信息</h4><p>在表单中加入表示关联的信息或在HTTP头部字段中加上用来判断相关性的信息(cookie).</p>
<h4 id="使用缓存服务器分担负载"><a href="#使用缓存服务器分担负载" class="headerlink" title="使用缓存服务器分担负载"></a>使用缓存服务器分担负载</h4><p>将整个系统按功能分成不同的服务器。</p>
<p>用户向缓存服务器发出请求，缓存服务器将请求保存在缓存中。</p>
<p>Via字段。</p>
<p>返回响应时可根据请求消息中URL的目录名判断。</p>
<p>数据积累。</p>
<p>如果请求内容在缓存中存在，返回If-Moified—Since头部字段，其中加上上次保存的时间，询问Web服务器在这个时间之后数据有没有发生变化。</p>
<h4 id="代理的基本原理"><a href="#代理的基本原理" class="headerlink" title="代理的基本原理"></a>代理的基本原理</h4><p>在客户端和Web服务器之间充当中间人的方式就是代理的基本原理。</p>
<h4 id="正向代理"><a href="#正向代理" class="headerlink" title="正向代理"></a>正向代理</h4><p>forward proxy。<br>在客户端一侧部署缓存服务器。</p>
<p>可用来实现防火墙。代理可以查看请求的内容。</p>
<p>访问过的数据会被缓存。</p>
<p>在客户端设置了代理，会在URI部分填写完整的网址。</p>
<p>使用正向代理需要在浏览器中设置。</p>
<h4 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h4><p>reverse proxy。<br>类似于服务器端的缓存服务器。<br>正向代理的改良版。</p>
<h4 id="透明代理"><a href="#透明代理" class="headerlink" title="透明代理"></a>透明代理</h4><p>transparent proxy。<br>位于请求消息从浏览器传输到Web服务器的路径中，当消息经过时进行拦截。</p>
<p>客户端处的缓存服务器：</p>
<ul>
<li>降低流量消耗</li>
<li>避免拥堵点</li>
</ul>
<h3 id="内容分发服务"><a href="#内容分发服务" class="headerlink" title="内容分发服务"></a>内容分发服务</h3><p>CDS，Content Delivery Service。或CDN，Content Delivery Network or Content Distribution Network。</p>
<p>提供这种服务的厂商叫CDSN，Content Delivery Service Provider。</p>
<p>该服务时将Web服务器可以控制的缓存服务器放在客户端的运营商处。</p>
<h4 id="让客户端找到最近的缓存服务器"><a href="#让客户端找到最近的缓存服务器" class="headerlink" title="让客户端找到最近的缓存服务器"></a>让客户端找到最近的缓存服务器</h4><hr>
<p>现在的局域网用光纤连接，范围可以很大且速度快。</p>
<h2 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h2><p>路由器和交换机不考虑请求包和响应包之间的关联。</p>
<p>一台服务器上可以运行多个服务器程序。</p>
<h3 id="服务器程序的结构"><a href="#服务器程序的结构" class="headerlink" title="服务器程序的结构"></a>服务器程序的结构</h3><p>每有一个客户端连接进来，就启动一个新的服务器程序，确保服务器程序和客户端是一对一的状态。</p>
<p>服务器程序启动时，读配置文件完成初始化。</p>
<p>程序分为两个模块：</p>
<ul>
<li>等待连接模块</li>
<li>负责与客户端通信的模块</li>
</ul>
<p>多任务，也可称为多进程，并发，就是一个处理器在多个程序之间快速切换。</p>
<h3 id="客户端和服务器的区别"><a href="#客户端和服务器的区别" class="headerlink" title="客户端和服务器的区别"></a>客户端和服务器的区别</h3><p>硬件部分有所不同，网络相关部分如网卡、协议栈等的功能是一样的，但用法上有差异。</p>
<hr>
<p>连接无法单方面连接，需要有一方等待连接，另一方才能发起连接。</p>
<p>客户端发起连接时，要指定服务器端的端口号。</p>
<h3 id="通信操作"><a href="#通信操作" class="headerlink" title="通信操作"></a>通信操作</h3><h4 id="套接字-1"><a href="#套接字-1" class="headerlink" title="套接字"></a>套接字</h4><p>调用listen向套接字写入等待信息，执行accept时，服务器端一般都处于包等待状态。连接时，创建一个等待连接的套接字的副本，写入连接对象等控制信息，并与客户端套接字连接在一起。</p>
<p>复制出一个新套接字之后，原来那个处于等待状态的套接字还会以等待状态继续存在。</p>
<p>关键点就是每次为新的连接创建新的套接字。</p>
<p>端口号是用来识别套接字的，新创建的套接字副本必需和原来等待连接的套接字具有相同的端口号。</p>
<p>以下四种信息判断套接字：</p>
<ul>
<li>客户端IP地址</li>
<li>客户端端口号</li>
<li>服务器IP地址</li>
<li>服务器端口号</li>
</ul>
<p>套接字中记录了当前时间点哪个程序正在与哪个对象进行通信。</p>
<p>应用程序之间使用描述符来指代套接字。</p>
<p>使用描述符来指代套接字的原因：</p>
<ul>
<li>等待连接的套接字中没有客户端的IP地址和端口号</li>
<li>使用描述符这一信息比较简单</li>
</ul>
<h4 id="光电信号转换为数字信号"><a href="#光电信号转换为数字信号" class="headerlink" title="光电信号转换为数字信号"></a>光电信号转换为数字信号</h4><p>电信号和光信号转换为数字信号：</p>
<ol>
<li>检测同步信号</li>
<li>延长时钟信号</li>
<li>分离时钟信号</li>
</ol>
<h4 id="IP模块处理数据包"><a href="#IP模块处理数据包" class="headerlink" title="IP模块处理数据包"></a>IP模块处理数据包</h4><p>协议栈的IP模块会检查IP头部：</p>
<ol>
<li>判断是不是发给自己的</li>
<li>判断网络包有没有分片</li>
<li>将包转发给TCP或UTP模块</li>
</ol>
<h4 id="TCP模块处理数据包"><a href="#TCP模块处理数据包" class="headerlink" title="TCP模块处理数据包"></a>TCP模块处理数据包</h4><p>如果收到的是发起连接的包，则TCP模块会：</p>
<ol>
<li>确认TCP头部的控制位SYN</li>
<li>检查接收方的端口号</li>
<li>为相应的等待连接的套接字复制一个新的副本</li>
<li>记录发送方的IP地址和端口号等信息。</li>
</ol>
<p>收到数据包：</p>
<ol>
<li>根据收到的包的发送方的IP地址、发送方端口号、接收方IP地址、接收方端口号找到相应的套接字</li>
<li>将数据块拼合起来并保存在接受缓存区</li>
<li>想客户端返回他ACK号</li>
</ol>
<p>断开连接，两边都可以发起，这里为服务器端：</p>
<ol>
<li>调用Socket库的close，TCP生成FIN为1的头部</li>
<li>客户端接收后返回一个ACK，然后调用close，生成FIN为1的TCP头部发送给服务器</li>
<li>服务器返回ACK</li>
</ol>
<h3 id="Web服务器程序解释请求消息并做出响应"><a href="#Web服务器程序解释请求消息并做出响应" class="headerlink" title="Web服务器程序解释请求消息并做出响应"></a>Web服务器程序解释请求消息并做出响应</h3><p>Web服务器公开的目录是虚拟目录。</p>
<p>文件名转换。</p>
<h4 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h4><p>常用在会员制的信息服务。<br>主要有以下3种：</p>
<ul>
<li>客户端IP地址</li>
<li>客户端域名</li>
<li>用户名和密码</li>
</ul>
<p>查询域名：</p>
<ol>
<li>协议栈将发送方的IP告知给Web服务器</li>
<li>服务器生成查询消息到最近的DNS服务器</li>
<li>DNS服务器找出负责管辖该IP的DNS服务器并转发查询消息</li>
<li>DNS服务器返回查询到的域名</li>
</ol>
<h4 id="返回响应"><a href="#返回响应" class="headerlink" title="返回响应"></a>返回响应</h4><p>调用Socket库的write，将响应消息交给协议栈，并通过使用套接字描述符告知这个消息该发送给谁。</p>
<h5 id="判断显示的数据类型和编码方式"><a href="#判断显示的数据类型和编码方式" class="headerlink" title="判断显示的数据类型和编码方式"></a>判断显示的数据类型和编码方式</h5><p>Content-Type类型</p>
<p><img src="/media/16523998935740.png" srcset="/img/loading.gif" lazyload></p>
<p>charset表示编码方式。</p>
<p>Content-Encoding，转换方式。</p>
<h4 id="浏览器显示内容"><a href="#浏览器显示内容" class="headerlink" title="浏览器显示内容"></a>浏览器显示内容</h4><p>实际的显示操作是由操作系统来完成的，浏览器负责对操作系统发出指令。</p>
<h1 id="整体图"><a href="#整体图" class="headerlink" title="整体图"></a>整体图</h1><p><img src="/media/16524182951589.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/media/16524182951170.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Web/" class="category-chain-item">Web</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>网络是怎样连接的</div>
      <div>http://example.com/2022/08/25/网络是怎样连接的/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月25日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/25/%E5%9B%BE%E8%A7%A3%20TCPIP/" title="图解 TCPIP.md">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">图解 TCPIP.md</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/25/%E8%B7%9F%E6%88%91%E4%B8%80%E8%B5%B7%E5%86%99%20Makefile/" title="跟我一起写 Makefile">
                        <span class="hidden-mobile">跟我一起写 Makefile</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
