

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/wallhaven-j5kjgy_1920x1080.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="learn vimscrip the hard way  第二次阅读14 Autocommand Groups需要用 augroup 包裹. 对同一个组多次使用 augroup 其会叠加. 用 augroup 可能是方便组织.如: 1234567augroup testgroup    autocmd BufWrite * :echom &quot;cat&quot;augroup ENDaugr">
<meta property="og:type" content="article">
<meta property="og:title" content="Learn Vimscript the Hard Way Notes">
<meta property="og:url" content="http://example.com/2022/08/25/Learn%20Vimscript%20the%20Hard%20Way%20Notes/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="learn vimscrip the hard way  第二次阅读14 Autocommand Groups需要用 augroup 包裹. 对同一个组多次使用 augroup 其会叠加. 用 augroup 可能是方便组织.如: 1234567augroup testgroup    autocmd BufWrite * :echom &quot;cat&quot;augroup ENDaugr">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/media/16565746214097.png">
<meta property="article:published_time" content="2022-08-25T02:17:54.000Z">
<meta property="article:modified_time" content="2022-11-11T13:50:12.222Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/media/16565746214097.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Learn Vimscript the Hard Way Notes - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Jie</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/SteinsGate_all.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Learn Vimscript the Hard Way Notes"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-25 10:17" pubdate>
          2022年8月25日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          13k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          113 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Learn Vimscript the Hard Way Notes</h1>
            
            
              <div class="markdown-body">
                
                <p><a target="_blank" rel="noopener" href="https://learnvimscriptthehardway.stevelosh.com/">learn vimscrip the hard way</a></p>
<hr>
<h1 id="第二次阅读"><a href="#第二次阅读" class="headerlink" title="第二次阅读"></a>第二次阅读</h1><h2 id="14-Autocommand-Groups"><a href="#14-Autocommand-Groups" class="headerlink" title="14 Autocommand Groups"></a>14 Autocommand Groups</h2><p>需要用 <code>augroup</code> 包裹. 对同一个组多次使用 <code>augroup</code> 其会叠加.</p>
<p>用 <code>augroup</code> 可能是方便组织.<br>如:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">augroup</span> testgroup<br>    <span class="hljs-keyword">autocmd</span> BufWrite * :<span class="hljs-keyword">echom</span> <span class="hljs-string">&quot;cat&quot;</span><br><span class="hljs-keyword">augroup</span> END<br><br><span class="hljs-keyword">augroup</span> testgroup<br>    <span class="hljs-keyword">autocmd</span> BufWrite * :<span class="hljs-keyword">echom</span> <span class="hljs-string">&quot;dog&quot;</span><br><span class="hljs-keyword">augroup</span> END<br></code></pre></td></tr></table></figure>
<p>要想重写则使用 <code>autocmd!</code></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">augroup</span> testgroup<br>    autocmd!<br>    <span class="hljs-keyword">autocmd</span> BufWrite * :<span class="hljs-keyword">echom</span> <span class="hljs-string">&quot;dog&quot;</span><br><span class="hljs-keyword">augroup</span> END<br></code></pre></td></tr></table></figure>
<p>针对某种文件:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">augroup</span> filetype_html<br>    autocmd!<br>    <span class="hljs-keyword">autocmd</span> FileType html <span class="hljs-keyword">nnoremap</span> <span class="hljs-symbol">&lt;buffer&gt;</span> <span class="hljs-symbol">&lt;localleader&gt;</span><span class="hljs-keyword">f</span> Vatzf<br></code></pre></td></tr></table></figure>

<h2 id="40-Paths"><a href="#40-Paths" class="headerlink" title="40 Paths"></a>40 Paths</h2><h3 id="40-1-Absolute-Paths"><a href="#40-1-Absolute-Paths" class="headerlink" title="40.1 Absolute Paths"></a>40.1 Absolute Paths</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">:<span class="hljs-keyword">echo</span> <span class="hljs-built_in">expand</span>(<span class="hljs-string">&#x27;%&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>输出当前文件名.</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">:<span class="hljs-keyword">echo</span> <span class="hljs-built_in">expand</span>(<span class="hljs-string">&#x27;%:p&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>输出当前路径。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">:<span class="hljs-keyword">echo</span> <span class="hljs-built_in">fnamemodify</span>(<span class="hljs-string">&#x27;foo.txt&#x27;</span>, <span class="hljs-string">&#x27;:p&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>指定当前目录下的一个文件名 (不管是否存在)，显示他的绝对路径.</p>
<h3 id="40-2-Listing-Files"><a href="#40-2-Listing-Files" class="headerlink" title="40.2 Listing Files"></a>40.2 Listing Files</h3><p>列出当前目录下的所有文件名.</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">:<span class="hljs-keyword">echo</span> <span class="hljs-built_in">globpath</span>(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>其返回的是一个 <code>string</code>, 每名字之间用换行符分隔. 为了提取出来，使用 <code>split()</code> 函数:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">:<span class="hljs-keyword">echo</span> <span class="hljs-keyword">split</span>(<span class="hljs-built_in">globpath</span>(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>), <span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><code>split()</code> 函数接受两个参数，第一个是一个 <code>string</code>, 第二个是分隔符.</p>
<h1 id="第一次阅读"><a href="#第一次阅读" class="headerlink" title="第一次阅读"></a>第一次阅读</h1><h2 id="1-Echoing-Messages"><a href="#1-Echoing-Messages" class="headerlink" title="1 Echoing Messages"></a>1 Echoing Messages</h2><p><code>:echo</code>和<code>:echom</code>的区别，后者的信息能被<code>:message</code>保存.</p>
<h2 id="2-Setting-Options"><a href="#2-Setting-Options" class="headerlink" title="2 Setting Options"></a>2 Setting Options</h2><p><code>?</code>可用来检查状态，如：</p>
<pre><code class="hljs">:set number?
#若没有设置行号，则显示
nonumber
</code></pre>
<h2 id="5-Strict-Mapping"><a href="#5-Strict-Mapping" class="headerlink" title="5 Strict Mapping"></a>5 Strict Mapping</h2><p><code>&lt;cr&gt;</code>表示回车键。<br><code>:nunmap /</code>取消<code>/</code>的map。</p>
<p><mark>Norecursive Mapping</mark><br>就是不会递归替换。<br><code>:*noremap</code>.</p>
<h2 id="6-2-Leader"><a href="#6-2-Leader" class="headerlink" title="6.2 Leader"></a>6.2 Leader</h2><p>前缀prefix在这里常叫<code>leader</code><br>改变leader：</p>
<pre><code class="hljs">:let mapleader = “-”
#然后执行
:nnoremap &lt;leader&gt;d dd
#此时-d代表dd 
</code></pre>
<p>感觉这像是一种约定俗成，而且便于修改你方便的前缀。</p>
<p>另一个可以用在特定文件的leader叫“local leader”，设置如下：</p>
<pre><code class="hljs">:let maplocalleader = “\\”
</code></pre>
<h1 id="2022-x2F-5-x2F-31"><a href="#2022-x2F-5-x2F-31" class="headerlink" title="2022&#x2F;5&#x2F;31"></a>2022&#x2F;5&#x2F;31</h1><h2 id="8-Abbreviations"><a href="#8-Abbreviations" class="headerlink" title="8 Abbreviations"></a>8 Abbreviations</h2><Keyword Characters>
The abbreviation will be expanded when you type anything that’s not a letter, number, or underscore.

<p>使用<code>:set iskeyword?</code>查看哪些是<code>keyword</code>,也就是不会被缩写abbreviation展开的字符。</p>
<p>Abbreviation 可以用来correcting typos。</p>
<h3 id="Abbreviation-和-mapping的区别"><a href="#Abbreviation-和-mapping的区别" class="headerlink" title="Abbreviation 和 mapping的区别"></a>Abbreviation 和 mapping的区别</h3><p>mapping会立即扩展，而abbreviation需要后面跟一个空格才会扩展。</p>
<h2 id="9-More-Mapping"><a href="#9-More-Mapping" class="headerlink" title="9 More Mapping"></a>9 More Mapping</h2><p>按下<code>viw</code>可以在可视模式下选中一个单词。</p>
<p>普通模式下<code>w</code>是光标移动到一个单词的末尾，<code>b</code>是移动到一个单词的开头。</p>
<h1 id="2022-x2F-6-x2F-1"><a href="#2022-x2F-6-x2F-1" class="headerlink" title="2022&#x2F;6&#x2F;1"></a>2022&#x2F;6&#x2F;1</h1><h2 id="11-Buffer-Local-Options"><a href="#11-Buffer-Local-Options" class="headerlink" title="11 Buffer-Local Options"></a>11 Buffer-Local Options</h2><p><code>&lt;buffer&gt;</code>, 告诉vim在当前缓冲区内使用次此命令。</p>
<pre><code class="hljs">:nnoremap &lt;buffer&gt; &lt;leader&gt;x dd
</code></pre>
<h3 id="Local-Leader"><a href="#Local-Leader" class="headerlink" title="Local Leader"></a>Local Leader</h3><p>When you create mapping that only applies to specific buffers you should use <local leader>    instead of <leader>.</p>
<h3 id="setting"><a href="#setting" class="headerlink" title="setting"></a>setting</h3><p><code>:setlocal</code> 作用于当前缓冲区。</p>
<p><code>:set</code>设置的是全局值。</p>
<p>一个window就是一个buffer。</p>
<p><code>:setglobal</code>,设置全局值，但不改变当前buffer的变量。</p>
<h1 id="2022-x2F-6-x2F-2"><a href="#2022-x2F-6-x2F-2" class="headerlink" title="2022&#x2F;6&#x2F;2"></a>2022&#x2F;6&#x2F;2</h1><h2 id="12-Autocommand"><a href="#12-Autocommand" class="headerlink" title="12 Autocommand"></a>12 Autocommand</h2><hr>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42239765/article/details/111847523">参考1</a></p>
<hr>
<p><code>autocmd</code>即自动命令，是在指定事件发生时自动执行的命令。</p>
<p>格式大概是：</p>
<pre><code class="hljs">:autocmd event filter command
如
:autocmd BufNewFile * :write
</code></pre>
<p><code>:w</code>是<code>:write</code>的缩写，意为将当前缓冲区的内容写入文件。</p>
<pre><code class="hljs">:normal gg=G
</code></pre>
<p>会告诉Vim to reindent the current file</p>
<p>The event type BufWritePre means the event will be checked just before you write any file.</p>
<p>所以说，event可能就是，检查的时机，后面的filter就是检查的对象。</p>
<p>查看有哪些<code>autocmd</code>的events</p>
<pre><code class="hljs">:help autocmd-events
</code></pre>
<p><mark>Multiple Events</mark></p>
<pre><code class="hljs">:autocmd BufWritePre,BufRead *.html :normal gg=G
</code></pre>
<p>一般把<code>BufRead</code>和<code>BufNewFile</code>两个events添加到一起。逗号连接时不能有空格。</p>
<pre><code class="hljs">:autocmd BufNewFile, BufRead *.html setlocal nowrap
</code></pre>
<p><mark>FileType Events</mark><br>最常用的就是<code>FileType</code>这个events。<br>如</p>
<pre><code class="hljs">:autocmd FileType JavaScript nnoremap &lt;buffer&gt; &lt;localleader&gt;c I//&lt;esc&gt;
</code></pre>
<p>将autocommand和buffer local mapping结合，可以创建特定的键位。</p>
<p><mark>自动折行</mark></p>
<pre><code class="hljs">:set wrap
</code></pre>
<p>就是把长的一行用多行显示。</p>
<pre><code class="hljs">:set textwidth=n
</code></pre>
<p>每行超过n各字符时自动换行。</p>
<h2 id="13-Buffer-local-Abbreviations"><a href="#13-Buffer-local-Abbreviations" class="headerlink" title="13 Buffer-local Abbreviations"></a>13 Buffer-local Abbreviations</h2><p>在<code>:iabbrev</code>中使用<code>&lt;buffer&gt;</code>.</p>
<p><code>&lt;left&gt;</code>即向左移动一个字符。</p>
<h3 id="autocmd-events-的几个前缀和后缀"><a href="#autocmd-events-的几个前缀和后缀" class="headerlink" title="autocmd-events 的几个前缀和后缀"></a>autocmd-events 的几个前缀和后缀</h3><p><code>Buf</code>都作为前缀，是与buffer相关的，如<code>BufNewFile</code>，就是在打开一个不存在的文件时触发。</p>
<p><code>Pre</code>都作为后缀， 意为在什么之前，如<code>BufReadPre</code>，就是在打开一个buffer后，在读文件之前触发。</p>
<p><code>Post</code>都作为后缀，意为在什么之后，如<code>BufReadPost</code>，就是在打开一个buffer后，在读文件之后触发。</p>
<p><code>Read</code>和<code>Write</code>一般是命令中间。</p>
<p><code>File</code>，与文件相关，如<code>FileType</code>。</p>
<p><code>Filter</code>与filter命令相关，如<code>FilterReadPre</code>。</p>
<h2 id="过滤器filter"><a href="#过滤器filter" class="headerlink" title="过滤器filter"></a>过滤器filter</h2><hr>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/130983572">参考</a></p>
<hr>
<h2 id="14-Autocommand-Groups-1"><a href="#14-Autocommand-Groups-1" class="headerlink" title="14 Autocommand Groups"></a>14 Autocommand Groups</h2><p>作用，防止重复定义。</p>
<pre><code class="hljs">autocmd!
</code></pre>
<p>能够clear前面相同的定义。</p>
<p>Read <code>:help autocmd-groups </code></p>
<h2 id="15-Operator-Pending-Mappings"><a href="#15-Operator-Pending-Mappings" class="headerlink" title="15 Operator-Pending Mappings"></a>15 Operator-Pending Mappings</h2><pre><code class="hljs">:onoremap p i(
</code></pre>
<p>这里的第一个<code>o</code>就是<code>operator</code>的意思。<br>此时用<code>dp</code>结果就是删除括号里面的。<br>用在等待一个动作时。</p>
<p>think way：</p>
<ol>
<li>Start at the cursor position</li>
<li>Enter visual mode(charwise)</li>
<li>…mapping keys go here…</li>
<li>Alll the text you want to include in the movement should now be selected.</li>
</ol>
<p>Read <code>:help omap-info</code></p>
<h2 id="16-More-Operator-Pending-Mappings"><a href="#16-More-Operator-Pending-Mappings" class="headerlink" title="16 More Operator-Pending Mappings"></a>16 More Operator-Pending Mappings</h2><h3 id="normal命令"><a href="#normal命令" class="headerlink" title="normal命令"></a>normal命令</h3><pre><code class="hljs">:normal
</code></pre>
<p>命令。</p>
<pre><code class="hljs">:normal gg
</code></pre>
<p>就是跳转到开头，所以，<code>normal</code>命令就是指在<code>:normal</code>模式下运行命令。</p>
<h3 id="execute命令"><a href="#execute命令" class="headerlink" title="execute命令"></a>execute命令</h3><pre><code class="hljs">:execute “write”
</code></pre>
<p>就是执行一段Vimscript命令。</p>
<h4 id="g"><a href="#g" class="headerlink" title="g_"></a>g_</h4><p>移动到the last non-blank character in the line.</p>
<hr>
<p>Read <code>:help pattern-overview</code><br>Read <code>:help normal</code><br>Read <code>:help execute</code><br>Read <code>:help expr-quote</code></p>
<h2 id="17-Status-Lines"><a href="#17-Status-Lines" class="headerlink" title="17 Status Lines"></a>17 Status Lines</h2><p>就是页面最下面那一行，可以改变输出的内容。</p>
<pre><code class="hljs">:set statusline=%f
</code></pre>
<p>Things that start with % are expanded to different text depending on what comes after them.</p>
<p>空白字符需转义。</p>
<pre><code class="hljs">:set statusline=%f\ -\ FileType:\ %y
</code></pre>
<p>在当前的statusline后面添加：</p>
<pre><code class="hljs">:set statusline+=FileType
</code></pre>
<p>查阅</p>
<pre><code class="hljs">:help statusline
</code></pre>
<h2 id="18-Responsible-Coding"><a href="#18-Responsible-Coding" class="headerlink" title="18 Responsible Coding"></a>18 Responsible Coding</h2><p>在normal模式下Fold you code by</p>
<pre><code class="hljs">za    
</code></pre>
<h3 id="fold-everything-automatically"><a href="#fold-everything-automatically" class="headerlink" title="fold everything automatically"></a>fold everything automatically</h3><pre><code class="hljs">:help foldlevelstart
</code></pre>
<p>设置<code>foldlevel</code>的值来决定fold。</p>
<p>一般情况：</p>
<pre><code class="hljs">set foldlevel=
</code></pre>
<p>放在autocmd前面，以便修改不同类型文件的foldlevel。</p>
<h2 id="19-Variables"><a href="#19-Variables" class="headerlink" title="19 Variables"></a>19 Variables</h2><p><code>set</code>和<code>let</code>的区别。</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/s634772208/article/details/78994790?utm_source=app&app_version=5.5.0">参考</a></p>
<hr>
<p>这里可能要区分选项options和变量variables。</p>
<p><code>set</code>只能用与设置选项，且不能进行运算，如</p>
<pre><code class="hljs">:set textwidth=100+1
</code></pre>
<p>会报错。</p>
<p><code>let</code>可以用于变量和选项，只不过修改选项时要加上<code>&amp;</code>，如</p>
<pre><code class="hljs">:let &amp;textwidth=100+1
</code></pre>
<p>修改变量时用<code>&amp;</code>就会报错。</p>
<p><code>set</code>还能查看选项的值，如</p>
<pre><code class="hljs">set textwidth?
</code></pre>
<p>以上设置的都是全局的变量和选项。</p>
<h3 id="Local-Options"><a href="#Local-Options" class="headerlink" title="Local Options"></a>Local Options</h3><pre><code class="hljs">:let &amp;1:number = 1
</code></pre>
<p>报错了。</p>
<h3 id="Registers-as-Variables"><a href="#Registers-as-Variables" class="headerlink" title="Registers as Variables"></a>Registers as Variables</h3><p>Read and set registers as variables.</p>
<pre><code class="hljs">:let @a = “hello!”
</code></pre>
<p>把寄存器a的值设置为“hello!”，可以在normal中引用寄存器的值</p>
<pre><code class="hljs">“ap
</code></pre>
<p>粘贴a的值。</p>
<p><code>”</code>寄存器，保存上一次复制粘贴的值，如</p>
<pre><code class="hljs">echo @“
</code></pre>
<p><code>/</code>寄存器，保存上一次查找的值，如</p>
<pre><code class="hljs">echo @/
</code></pre>
<p>You should never use <code>let</code> if <code>set</code> will suffice.</p>
<p>Read <code>:help registers</code>.</p>
<h2 id="Variable-Scoping"><a href="#Variable-Scoping" class="headerlink" title="Variable Scoping"></a>Variable Scoping</h2><p>Like</p>
<pre><code class="hljs">:let b:hello = “world”
</code></pre>
<p><code>b:</code> is a scope for variables, 表示设置为局部值。</p>
<p>浏览scopes表<code>:help internal-variables</code></p>
<h2 id="21-Conditionals"><a href="#21-Conditionals" class="headerlink" title="21 Conditionals"></a>21 Conditionals</h2><h3 id="Multiple-Line-Statements"><a href="#Multiple-Line-Statements" class="headerlink" title="Multiple-Line Statements"></a>Multiple-Line Statements</h3><p>Use <code>|</code> to separate each line</p>
<pre><code class="hljs">:echom “foo” | echom “bar”
</code></pre>
<h3 id="Basic-if"><a href="#Basic-if" class="headerlink" title="Basic if"></a>Basic if</h3><pre><code class="hljs">:if 1
:   echom “ZERO”
:endif
</code></pre>
<p>Vimscript中的字符串的值要根据上下文判断。如</p>
<pre><code class="hljs">if “10” #这里表示数字
if “10num” #这里也表示数字
if “num10” #这里不是数字了
“hello” + 10 #值为10
</code></pre>
<h3 id="else-和-elseif"><a href="#else-和-elseif" class="headerlink" title="else 和 elseif"></a>else 和 elseif</h3><pre><code class="hljs">if  0
    echom “if”
elseif “nope!”
    echom “elseif”
else 
    echom “finally”
endif
</code></pre>
<h2 id="22-Comparisons"><a href="#22-Comparisons" class="headerlink" title="22 Comparisons"></a>22 Comparisons</h2><pre><code class="hljs">if 10 &gt; 1
    echom “foo”
endif
</code></pre>
<h3 id="Case-Sensitivity"><a href="#Case-Sensitivity" class="headerlink" title="Case Sensitivity"></a>Case Sensitivity</h3><pre><code class="hljs">:set noignorecase
:set ignorecase
</code></pre>
<p>设置大小写敏感。</p>
<h3 id="Code-Defensively"><a href="#Code-Defensively" class="headerlink" title="Code Defensively"></a>Code Defensively</h3><p>A bare “&#x3D;&#x3D;” should never appear in your plugins’ code.    </p>
<p><code>==?</code> case-insensitive no matter what the user has set.</p>
<p><code>==#</code> case-sensitive no matter what the user has set.</p>
<p>在数字做比较是也多用上面两个operator。</p>
<p>Read :help ignorecase<br>Read :help expr4</p>
<h2 id="23-Functions"><a href="#23-Functions" class="headerlink" title="23 Functions"></a>23 Functions</h2><p>Define the function</p>
<pre><code class="hljs">function Meow()
    echom “Meow!”
endfunction
</code></pre>
<p>Running the function</p>
<pre><code class="hljs">call Meow()
</code></pre>
<p>Returning a value</p>
<pre><code class="hljs">function GetMeow()
    return “Meow String!”
endfunction
</code></pre>
<h3 id="Implicit-Returning"><a href="#Implicit-Returning" class="headerlink" title="Implicit Returning"></a>Implicit Returning</h3><p>没有明确的写<code>return</code>的话，会有implicit returning.</p>
<p>Read <code>:help call</code></p>
<p>Read <code>:help E124</code> 看那些可以当作函数名。 must start with a capital or “s:”</p>
<p>Read <code>:help return</code></p>
<h2 id="24-Function-Arguments"><a href="#24-Function-Arguments" class="headerlink" title="24 Function Arguments"></a>24 Function Arguments</h2><h3 id="对scope的理解"><a href="#对scope的理解" class="headerlink" title="对scope的理解"></a>对scope的理解</h3><p>可能是和名称空间差不多的玩意。</p>
<p><code>a:name</code>这里的<code>:a</code>表示variable scope。</p>
<p>所有的变量调用时都要加上<code>a:</code></p>
<p>Global variable need to be accessed with <code>:g</code>.</p>
<hr>
<h3 id="Varargs"><a href="#Varargs" class="headerlink" title="Varargs"></a>Varargs</h3><pre><code class="hljs">function Varg(...)
    echom a:0
    echom a:1
    echom a:000
endfunction
</code></pre>
<p><code>a:0</code>表示extra variable的数量。</p>
<p><code>a:1</code>表示第一个extra variable的值。</p>
<p><code>a:000</code>表示所有extra variable的列表。</p>
<h3 id="Assignment"><a href="#Assignment" class="headerlink" title="Assignment"></a>Assignment</h3><pre><code class="hljs">function AssignGood(foo)
    let a:foo_tmp = a:foo
endfunction
</code></pre>
<p>Read <code>:help function-argument</code><br>Read <code>:help local-variables</code></p>
<h2 id="25-Numbers"><a href="#25-Numbers" class="headerlink" title="25 Numbers"></a>25 Numbers</h2><p>Two types:</p>
<ul>
<li>Numbers, 32 bit signed</li>
<li>Floats</li>
</ul>
<p>以<code>0</code>开头的数字表示octal number，以<code>0x</code>开头的数字表示hex。</p>
<pre><code class="hljs">echo 5e4
</code></pre>
<p>会报错。</p>
<h3 id="Coercion"><a href="#Coercion" class="headerlink" title="Coercion"></a>Coercion</h3><pre><code class="hljs">echo 2 * 2.0
</code></pre>
<p>结果为浮点数。</p>
<h3 id="division"><a href="#division" class="headerlink" title="division"></a>division</h3><pre><code class="hljs">echo 3 / 2 
</code></pre>
<p>结果为1.</p>
<pre><code class="hljs">echo 3 / 2.0
</code></pre>
<p>结果为1.5.</p>
<p>Read <code>:help Float</code><br>Read <code>:help float-point-precision</code></p>
<h2 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h2><h3 id="Concatenation"><a href="#Concatenation" class="headerlink" title="Concatenation"></a>Concatenation</h3><pre><code class="hljs">echom “Hello,” + “world”
</code></pre>
<p>输出0，vim的<code>+</code>只用于numbers。</p>
<p>vim不会coerce string to float</p>
<pre><code class="hljs">echom 10 + “10.10”
</code></pre>
<p>输出20.</p>
<p><code>.</code> is the concatenate strings operator.</p>
<pre><code class="hljs">echom “Hello， ” . “world”
</code></pre>
<p>将两个string连接起来。</p>
<pre><code class="hljs">echom 10.1 . “foo”
</code></pre>
<p>会报错。</p>
<p>Don’t rely on Vim’s coercion.</p>
<h3 id="Special-Characters"><a href="#Special-Characters" class="headerlink" title="Special Characters"></a>Special Characters</h3><p>用<code>\</code>转义。</p>
<p><code>foo^@bar</code>中的<code>^@</code> is Vim’s way of saying “newline character”.</p>
<h3 id="Literal-Strings"><a href="#Literal-Strings" class="headerlink" title="Literal Strings"></a>Literal Strings</h3><p>使用单引号<code>’ ’</code>。</p>
<p>里面没有转义字符。</p>
<pre><code class="hljs">echom ‘\n\\’
</code></pre>
<p>显示<code>\n\\</code>.</p>
<h3 id="Truthiness"><a href="#Truthiness" class="headerlink" title="Truthiness"></a>Truthiness</h3><hr>
<p>Read <code>:help express-quote</code><br>Read <code>:help i_CTRL-V</code><br>Read <code>:help literal-string</code></p>
<hr>
<h2 id="27-String-Functions"><a href="#27-String-Functions" class="headerlink" title="27 String Functions"></a>27 String Functions</h2><h3 id="Length"><a href="#Length" class="headerlink" title="Length"></a>Length</h3><pre><code class="hljs">echom strlen(“foo”)
</code></pre>
<h3 id="Splitting"><a href="#Splitting" class="headerlink" title="Splitting"></a>Splitting</h3><pre><code class="hljs">echo split(“one two three”)
</code></pre>
<p>输出<code>[‘one’, ‘two’, ‘three’]</code>.</p>
<p>将字符串分解为list。</p>
<pre><code class="hljs">echo split(“one, two, three”, “,”)
</code></pre>
<p>输出<code>[‘one’, ‘two’, ‘three’]</code>，此时是以<code>,</code>作为分隔，若不指定则默认为空白字符。</p>
<h3 id="Joining"><a href="#Joining" class="headerlink" title="Joining"></a>Joining</h3><pre><code class="hljs">echo join([“foo”, “bar”], “...”)
</code></pre>
<p>输出<code>foo...bar</code>，就是用后面指定的符号连接列表中的各元素。</p>
<p>和split配合使用</p>
<pre><code class="hljs">echo join(split(“foo bar”), “;”)
</code></pre>
<p>输出<code>foo;bar</code>.</p>
<h3 id="Lower-and-Upper-Case"><a href="#Lower-and-Upper-Case" class="headerlink" title="Lower and Upper Case"></a>Lower and Upper Case</h3><pre><code class="hljs">echom tolower(“Foo”)
echom toupper(“Foo”)
</code></pre>
<hr>
<p>Read <code>:help split()</code><br>Read <code>:help join()</code><br>Read <code>:help functions</code></p>
<hr>
<h2 id="28-Execute"><a href="#28-Execute" class="headerlink" title="28 Execute"></a>28 Execute</h2><p>判断一个字符串是否是Vimscript的命令。</p>
<h3 id="Basic-Excution"><a href="#Basic-Excution" class="headerlink" title="Basic Excution"></a>Basic Excution</h3><pre><code class="hljs">execute “echom ‘Hello, world!’”
</code></pre>
<p>输出<code>’Hello world!’</code></p>
<p>Can not be followed by a comment.</p>
<hr>
<p>Read <code>:help execute</code></p>
<p>Read <code>:help leftabove</code>, <code>:help rightbelow</code>,<code>:help split</code>,<code>:help vsplit</code>.</p>
<hr>
<h2 id="29-Normal"><a href="#29-Normal" class="headerlink" title="29 Normal"></a>29 Normal</h2><pre><code class="hljs">normal G
</code></pre>
<p>移动到文件底部。</p>
<h3 id="Avoiding-Mapping"><a href="#Avoiding-Mapping" class="headerlink" title="Avoiding Mapping"></a>Avoiding Mapping</h3><p>使用<code>normal!</code>相当于norecuision的作用，在写Vimscript的时候要用<code>normal!</code>。</p>
<h3 id="Special-Characters-1"><a href="#Special-Characters-1" class="headerlink" title="Special Characters"></a>Special Characters</h3><p><code>normal!</code>不能识别特殊字符如<code>&lt;cr&gt;</code>它会将其视为<code>‘&lt;’ ‘c’ ’r’ ’&gt;’</code>.</p>
<p><code>execute</code>和<code>normal!</code>结合可以解决以上问题。</p>
<pre><code class="hljs">:execute “normal! gg/foo\&lt;cr&gt;dd”
</code></pre>
<p>此处要使用转义<code>\</code></p>
<hr>
<p>Read <code>:help normal</code></p>
<hr>
<h3 id="Extra-Credit"><a href="#Extra-Credit" class="headerlink" title="Extra Credit"></a>Extra Credit</h3><p>Skip 掉了</p>
<h2 id="30-Execute-Normal"><a href="#30-Execute-Normal" class="headerlink" title="30 Execute Normal!"></a>30 Execute Normal!</h2><p>Read <code>:help express-quote</code></p>
<h2 id="31-Basic-Regular-Expressions"><a href="#31-Basic-Regular-Expressions" class="headerlink" title="31 Basic Regular Expressions"></a>31 Basic Regular Expressions</h2><p>Use <code>?</code> to search backward instead of forward.</p>
<pre><code class="hljs">execute “normal! G?print\&lt;cr&gt;”
</code></pre>
<p>也就是说<code>/</code>是以forward的方式查找，<code>?</code>是以backward的方式查找。</p>
<h3 id="Magic"><a href="#Magic" class="headerlink" title="Magic"></a>Magic</h3><p><code>magic</code>选项就是存在<code>\n</code>这类普通字符前面加一个<code>\</code>就有了特殊含义，以及<code>\.</code>将原本有特殊含义的词变为普通的字符。</p>
<pre><code class="hljs">execute “normal! gg/for .\\+ in .\\+:\&lt;cr&gt;”
</code></pre>
<p>此处的正则表达式中的<code>+</code>需写成<code>\+</code>才能发挥作用，所以<code>\\</code>是为了转义一个<code>\</code>.</p>
<p>在Vim中，单引号阔起来的都表示单个字符如<code>a\nb</code>，表示四个字符。</p>
<pre><code class="hljs">:execute “normal! gg” . ‘/for .\+ in .\+:’ . “\&lt;cr&gt;”
</code></pre>
<h3 id="Very-Magic"><a href="#Very-Magic" class="headerlink" title="Very Magic"></a>Very Magic</h3><p>Very magic就是：所有的ASCII字符除了 ‘0’-‘9’， ‘a’-‘z’，‘A’-‘Z’和‘_’外的字符都有特殊含义。</p>
<p>Vim 有四种parse regex的方法，添加<code>\v</code>能够让这种regex语法最接近其他语言中的正则表达式, <code>\v</code>是”very magic“模式。</p>
<pre><code class="hljs">‘/\vfor .+ in .+:’
</code></pre>
<hr>
<p>Read <code>:help magic</code><br>Read <code>:help pattern-overview</code><br>Read <code>:help match</code><br>Read <code>:help nohlsearch</code></p>
<hr>
<h2 id="32-Case-Study-Grep-Operator-Part-One"><a href="#32-Case-Study-Grep-Operator-Part-One" class="headerlink" title="32 Case Study: Grep Operator, Part One"></a>32 Case Study: Grep Operator, Part One</h2><hr>
<p>Read <code>:help grep</code><br>Read <code>:help make</code><br>Read <code>:help quickfix-window</code></p>
<hr>
<h3 id="Escaping-Shell-Command-Arguments"><a href="#Escaping-Shell-Command-Arguments" class="headerlink" title="Escaping Shell Command Arguments"></a>Escaping Shell Command Arguments</h3><p><code>&lt;cword&gt;</code>用在命令中，Vim会在命令被执行前把它替换为光标下的单词。</p>
<p><code>&lt;cWORD&gt;</code>会替换为整个单词。</p>
<p>两个的区别在如foo-bar, 前者会替换为foo，后者会替换为foo-bar.</p>
<p>Vim会在如<code>&lt;cword&gt;</code>扩展之前就运行shellescape()，因此要使用expand(), 让<code>&lt;cword&gt;</code>在shellescape()执行之前展开。</p>
<pre><code class="hljs">:nnoremap &lt;leader&gt;g :execute “grep！ -R ” . shellescape(expand(“&lt;cWORD&gt;”)) . “ .”&lt;cr&gt;:copen&lt;cr&gt;
</code></pre>
<p><code>grep!</code>防止跳转至第一条。</p>
<p><code>copen</code>的作用是打开quickfix，可调整高度。</p>
<p><code>cnext</code>是切换到下一个error的位置。</p>
<p><code>cprevious</code>是切换到前一个。</p>
<hr>
<p>Read <code>:help :grep</code><br>Read <code>:help cword</code><br>Read <code>:help cnext</code><br>Read <code>:help cprevious</code><br>Read <code>:help expand</code><br>Read <code>:help copen</code><br>Read <code>:help silent</code></p>
<hr>
<h2 id="33-Case-Study-Grep-Operator-Part-Two"><a href="#33-Case-Study-Grep-Operator-Part-Two" class="headerlink" title="33 Case Study: Grep Operator, Part Two"></a>33 Case Study: Grep Operator, Part Two</h2><p><code>～/vim/plugin</code>目录，操作其中的文件时可以用<code>:source %</code>加载。</p>
<hr>
<h3 id="Visual-Mode"><a href="#Visual-Mode" class="headerlink" title="Visual Mode"></a>Visual Mode</h3><p><code>&lt;c-u&gt;</code>的作用，避免出现<code>:’&lt;,’&gt;</code>.</p>
<p><code>visualmode()</code>返回visualmode的模式。</p>
<p>变量由<code>@</code>开头的都是寄存器。</p>
<p><code>@@</code>是未命名的寄存器，存放复制和删除的text(未指定寄存器的)。</p>
<p><code>function!</code>前面的<code>!</code>表示重写一个function。</p>
<hr>
<p>Read <code>:help visulmode</code><br>Read <code>:help c_ctrl-u</code><br>Read <code>:help operatorfunc</code><br>Read <code>:help map-operator</code></p>
<hr>
<p><code>operatorfunc</code>是个选项，如</p>
<pre><code class="hljs">:set operatorfunc=GrepOperator
</code></pre>
<p>这样，就可以用<code>g@</code>来调用GrepOperator这个函数。</p>
<p>‘&#96;[‘放在定义为motion的text前面.</p>
<hr>
<h2 id="34-Case-Study-Grep-Operator-Part-Three"><a href="#34-Case-Study-Grep-Operator-Part-Three" class="headerlink" title="34 Case Study: Grep Operator, Part Three"></a>34 Case Study: Grep Operator, Part Three</h2><hr>
<h3 id="Namespacing"><a href="#Namespacing" class="headerlink" title="Namespacing"></a>Namespacing</h3><p><SID>, 会被扩展为<code>&lt;SNR&gt;num</code>num表示一个特殊的数字。</p>
<p><code>s:</code>添加到函数前，使之处于当前的名称空间。</p>
<hr>
<p>Read <code>:help &lt;SID&gt;</code></p>
<hr>
<h2 id="35-Lists"><a href="#35-Lists" class="headerlink" title="35 Lists"></a>35 Lists</h2><h3 id="indexing"><a href="#indexing" class="headerlink" title="indexing"></a>indexing</h3><p><code>0</code>表示第一个元素。</p>
<p><code>-1</code>表示倒数第一个元素，<code>-2</code>表示倒数第二个元素。</p>
<hr>
<h3 id="slicing"><a href="#slicing" class="headerlink" title="slicing"></a>slicing</h3><p>分割。</p>
<pre><code class="hljs">:echo [‘a’, ‘b’, ‘c’, ‘d’, ‘e’][0:2]
</code></pre>
<p>显示<code>[’a’, ‘b’ , ‘c’]</code> </p>
<hr>
<h3 id="Concatenation-1"><a href="#Concatenation-1" class="headerlink" title="Concatenation"></a>Concatenation</h3><pre><code class="hljs">:echo [‘a’, ’b’] + [‘c’]
</code></pre>
<hr>
<h3 id="List-Function"><a href="#List-Function" class="headerlink" title="List Function"></a>List Function</h3><p>Read <code>:help List</code><br>Read <code>:help add()</code><br>Read <code>:help len()</code><br>Read <code>:help get()</code><br>Read <code>:help index()</code><br>Read <code>:help join()</code><br>Read <code>:help reverse()</code><br>Read <code>:help functions</code></p>
<hr>
<h2 id="36-Looping"><a href="#36-Looping" class="headerlink" title="36 Looping"></a>36 Looping</h2><h3 id="For-Loops"><a href="#For-Loops" class="headerlink" title="For Loops"></a>For Loops</h3><pre><code class="hljs">:let c = 0
:for i in [1, ,2 ,3, 4]
:  let c += i
:endfor

:echo c
</code></pre>
<hr>
<h3 id="While-Loops"><a href="#While-Loops" class="headerlink" title="While Loops"></a>While Loops</h3><pre><code class="hljs">:let c = 1
:let total = 0

:while c &lt;= 4
:  let total += c
:  let c += 1
:endwhile

:echom total
</code></pre>
<hr>
<p>Read <code>:help for</code><br>Read <code>:help while</code></p>
<hr>
<h2 id="Dictionaries"><a href="#Dictionaries" class="headerlink" title="Dictionaries"></a>Dictionaries</h2><pre><code class="hljs">:echo &#123;‘a’: 1, 100: ‘foo’&#125;

:echo &#123;‘a’: 1, 100: ‘foo’,&#125;
</code></pre>
<hr>
<h3 id="Indexing"><a href="#Indexing" class="headerlink" title="Indexing"></a>Indexing</h3><pre><code class="hljs">:echo &#123;‘a’: 1, 100: ‘foo’,&#125;[‘a’]

:echo &#123;‘a’: 1, 100: ‘foo’,&#125;.a
</code></pre>
<hr>
<h3 id="Assigning-and-Adding"><a href="#Assigning-and-Adding" class="headerlink" title="Assigning and Adding"></a>Assigning and Adding</h3><pre><code class="hljs">:let foo = &#123;‘a’: 1&#125;
:let foo.a = 100
:let foo.b = 200
:echo foo
</code></pre>
<hr>
<h3 id="Removing-Entries"><a href="#Removing-Entries" class="headerlink" title="Removing Entries"></a>Removing Entries</h3><pre><code class="hljs">:let test = remove(foo, ‘a’)
:unlet foo.b
:echo foo
:echo test
</code></pre>
<p>多数使用<code>remove()</code></p>
<hr>
<h3 id="Dictionary-Function"><a href="#Dictionary-Function" class="headerlink" title="Dictionary Function"></a>Dictionary Function</h3><p>Read <code>:help Dictionary</code><br>Read <code>:help get()</code><br>Read <code>:help has_key()</code><br>Read <code>:help items()</code><br>Read <code>:help keys()</code><br>Read <code>:help values()</code></p>
<hr>
<h2 id="38-Toggling"><a href="#38-Toggling" class="headerlink" title="38 Toggling"></a>38 Toggling</h2><h3 id="Restoring-Windows-x2F-Buffers"><a href="#Restoring-Windows-x2F-Buffers" class="headerlink" title="Restoring Windows&#x2F;Buffers"></a>Restoring Windows&#x2F;Buffers</h3><p>每一个window都有一个号。</p>
<hr>
<p>Read <code>:help foldcolumn</code><br>Read <code>:help winnr()</code><br>Read <code>:help ctrl-w_w</code><br>Read <code>:help wincmd</code></p>
<hr>
<pre><code class="hljs">execute a:number . “wincmd operator”
</code></pre>
<hr>
<h3 id="Functional-Programming"><a href="#Functional-Programming" class="headerlink" title="Functional Programming"></a>Functional Programming</h3><hr>
<h3 id="Functions-as-Variables"><a href="#Functions-as-Variables" class="headerlink" title="Functions as Variables"></a>Functions as Variables</h3><p>可以用变量存储函数，这时变量要以大写字母开头</p>
<pre><code class="hljs">:let Myfunc = function(“Append”)
:echo Myfunc([1, 2], 3)
</code></pre>
<hr>
<h3 id="Higher-Order-Function"><a href="#Higher-Order-Function" class="headerlink" title="Higher-Order Function"></a>Higher-Order Function</h3><p>就是通过调用其他函数完成任务的函数。</p>
<p>Read <code>:help map</code><br>Read <code>:help sort()</code><br>Read <code>:help reverse()</code><br>Read <code>:help copy()</code><br>Read <code>:help deepcopy()</code><br>Read <code>:help function()</code><br>Read <code>:help type()</code></p>
<hr>
<h2 id="40-Paths-1"><a href="#40-Paths-1" class="headerlink" title="40 Paths"></a>40 Paths</h2><p><code>%</code> 表示当前文件。</p>
<p><code>%:p</code>表示绝对路径。</p>
<p>Read <code>:help expand()</code><br>Read <code>:help fnamemodify()</code><br>Read <code>:help filename-modifiers</code><br>Read <code>:help simplify</code><br>Read <code>:help resolve()</code><br>Read <code>:help globpath()</code><br>Read <code>:help wildcards</code></p>
<hr>
<h2 id="41-Creating-a-Full-Plugin"><a href="#41-Creating-a-Full-Plugin" class="headerlink" title="41 Creating a Full Plugin"></a>41 Creating a Full Plugin</h2><hr>
<h2 id="42-Plugin-Layout-in-the-Dark-Ages"><a href="#42-Plugin-Layout-in-the-Dark-Ages" class="headerlink" title="42 Plugin Layout in the Dark Ages"></a>42 Plugin Layout in the Dark Ages</h2><hr>
<h2 id="43-A-New-Hope-Plugin-Layout-with-Pathogen"><a href="#43-A-New-Hope-Plugin-Layout-with-Pathogen" class="headerlink" title="43 A New Hope: Plugin Layout with Pathogen"></a>43 A New Hope: Plugin Layout with Pathogen</h2><hr>
<h2 id="45-Basic-Syntax-Highlighting"><a href="#45-Basic-Syntax-Highlighting" class="headerlink" title="45 Basic Syntax Highlighting"></a>45 Basic Syntax Highlighting</h2><p>注意防止重复加载的判断，和防止多次加载头文件一样。</p>
<hr>
<p>Read <code>:help syn-keyword</code><br>Read <code>:help iskeyword</code><br>Read <code>:help group-name</code></p>
<hr>
<p>syn-keyword中的option, 就是可以用简写。</p>
<p>把你自己的group link 到其他的group，就可以有一样的highlighting。大小写不敏感。</p>
<hr>
<h2 id="46-Advanced-Syntax-Highlighting"><a href="#46-Advanced-Syntax-Highlighting" class="headerlink" title="46 Advanced Syntax Highlighting"></a>46 Advanced Syntax Highlighting</h2><p><code>syntax keyword</code>的作用大概是自己定义一个keyword group。</p>
<p><code>syntax match</code>同样要自己定义一个group，只不过后面跟的是正则表达式。其不允许一行多个group。</p>
<p>后定义的group有更高的优先级。</p>
<p>Keyword的优先级高于Match和Region.</p>
<p>如：</p>
<pre><code class="hljs">syntax match potionComment “\v#.*$”
</code></pre>
<hr>
<p>Read <code>:help syn-match</code><br>Read <code>:help syn-priority</code></p>
<hr>
<h2 id="47-Even-More-Advanced-Syntax-Highlighting"><a href="#47-Even-More-Advanced-Syntax-Highlighting" class="headerlink" title="47 Even More Advanced Syntax Highlighting"></a>47 Even More Advanced Syntax Highlighting</h2><p>Read <code>:help syntax</code></p>
<hr>
<h3 id="Highlighting-Strings"><a href="#Highlighting-Strings" class="headerlink" title="Highlighting Strings"></a>Highlighting Strings</h3><p>用<code>syntax region</code>, 注意<code>start</code>,<code>skip</code>,<code>end</code></p>
<p>Read <code>:help syn-region</code></p>
<hr>
<h2 id="48-Basic-Folding"><a href="#48-Basic-Folding" class="headerlink" title="48 Basic Folding"></a>48 Basic Folding</h2><p>Read <code>:help usr_28</code></p>
<hr>
<p>所有的fold操作以<code>z</code>开头。</p>
<p>保存fold，<code>mkview</code> 和 <code>loadview</code>.</p>
<p>用<code>viewdir</code> 选项查看。</p>
<p>按照缩进fold<code>set foldmethod=indent</code></p>
<p><code>foldlevel</code>和<code>shiftwidth</code>相关。</p>
<p>利用<code>foldmethod</code>选择折叠方式。</p>
<hr>
<p><mark>Vim中local和全局的作用。</mark></p>
<p>设置了local之后，会更加specific，因此优先级会更高。</p>
<hr>
<p>Read <code>:help foldmethod</code><br>Read <code>:help fold-manual</code><br>Read <code>:help fold-marker</code><br>Read <code>:help help foldmarkr</code><br>Read <code>:help fold-indent</code><br>Read <code>:help fdl</code><br>Read <code>:help foldlevelstart</code><br>Read <code>:help foldminlines</code><br>Read <code>:help foldignore</code></p>
<hr>
<h2 id="49-Advanced-Folding"><a href="#49-Advanced-Folding" class="headerlink" title="49 Advanced Folding"></a>49 Advanced Folding</h2><h3 id="Folding-Theory"><a href="#Folding-Theory" class="headerlink" title="Folding Theory"></a>Folding Theory</h3><p>每一行代码都有一个<code>foldlevel</code>.</p>
<p>当前自己的理解，一个tab键的缩进就是让foldlevel加1，fold indent是按照每一行的foldlevel折叠的，相邻的折在一起，但相邻的foldlevel不一定相等。</p>
<hr>
<h3 id="Getting-Started"><a href="#Getting-Started" class="headerlink" title="Getting Started"></a>Getting Started</h3><p>每当<code>:set filetype=potion</code>时，都会加载<code>ftplugin/potion</code>.</p>
<hr>
<h3 id="Expr-Folding"><a href="#Expr-Folding" class="headerlink" title="Expr Folding"></a>Expr Folding</h3><p><code>foldignore</code>只对<code>foldmethod</code>为indent时有效。</p>
<p>字符<code>’-1’</code>表示这一行的foldlevel是<code>undefined</code>, 这一行的foldlevel会和the line above or below哪一个的foldlevel小，就等于哪一个。</p>
<hr>
<p>Read <code>:help foldexpr</code><br>Read <code>:help fold-expr</code><br>Read <code>:help getline</code><br>Read <code>:help indent()</code><br>Read <code>:help line()</code></p>
<hr>
<h3 id="An-Indentation-Level-Helper"><a href="#An-Indentation-Level-Helper" class="headerlink" title="An Indentation Level Helper"></a>An Indentation Level Helper</h3><p><code>shiftwidth</code>的值就是一个<code>tab</code>键的长度。<code>tabstop</code>的值也是<code>tab</code>的空格数。</p>
<p><code>indent()</code>返回某一行的前面的space数。</p>
<p><code>=～？</code>的意思是后面为正则表达式且大小写不敏感。</p>
<p><code>&gt;</code>表示另一个Vim中的特殊<code>foldlevel</code>, 如<code>&gt;1</code>告诉Vim以1从这个foldlevel打开当前行。记忆方法，从左到右可以进去，所以是从这里开始打开。</p>
<hr>
<p><mark>对fold的理解</mark><br>这个玩意就是靠foldlevel来fold，比如的<code>foldmethod=indent</code>时，此时的foldlevel取决于indent数量。</p>
<p>当<code>foldmethod=expr</code>时，此时的foldlevel取决于后面表达式的值，后面的返回值也是数字，来表示foldlevel，这个<code>foldexpr=</code>后面一个东西会对每一行计算，最终会算出每一行的foldlevel。所以当我之前设置<code>:set foldexpr=1</code>的时候会全部折叠，其实不管我后面写多少都会全部折叠，因为这样写相当于我把每一行的foldlevel都设置为了1.</p>
<p>这下子<mark>fold的原则</mark>就通透了：</p>
<ol>
<li>每一行都有一个foldlevel。</li>
<li>foldlevel为0则不会折叠。</li>
<li>相邻的行若有相同的foldlevel则折叠在一起。</li>
<li>当一个foldlevel如1折叠时，随后的行中若foldlevel高于1也会折叠，直到一个低于1的。</li>
</ol>
<p><mark>对<code>foldexpr</code>的理解</mark><br>foldexpr得到一个值，进而判断这一行是否为fold。</p>
<hr>
<h2 id="50-Section-Movement-Theory"><a href="#50-Section-Movement-Theory" class="headerlink" title="50 Section Movement Theory"></a>50 Section Movement Theory</h2><p>Read <code>:help section</code></p>
<hr>
<h3 id="Nroff"><a href="#Nroff" class="headerlink" title="Nroff"></a>Nroff</h3><p>nroff和troff都起源于roff，是一种类似于LaTex和Markdown的语言，用于UNIX和UNIX-like操作系统，是man page的排版格式。</p>
<p>.SH是section heading.</p>
<hr>
<p><code>[[</code>和<code>]]</code>用于找<code>&#123;</code>.</p>
<p><code>[]</code>和<code>][</code>用于找<code>&#125;</code>.</p>
<hr>
<h2 id="51-Potion-Section-Movement"><a href="#51-Potion-Section-Movement" class="headerlink" title="51 Potion Section Movement"></a>51 Potion Section Movement</h2><p>Read <code>:help line-continuation</code></p>
<p><mark><SID></mark><br>首先，<code>&lt;SID&gt;</code>在脚本运行时会被扩展为<code>&lt;SNR&gt;12_</code>，12是我随便写的数字，所以可以把<SID>视为下面的简写形式，这个数字是用于标记当前脚本的unique number。</p>
<p>它解决了一个问题，在Vim中，你调用了一个函数，它不知道其在哪里定义的，<SID>能让Vim找到它的定义。</p>
<hr>
<h3 id="Base-Movement"><a href="#Base-Movement" class="headerlink" title="Base Movement"></a>Base Movement</h3><p><code>%^</code> a special Vim regent atom that means “beginning of file”</p>
<p>Read <code>:help search()</code><br>Read <code>:help ordinary-atom</code></p>
<hr>
<h2 id="52-External-Commands"><a href="#52-External-Commands" class="headerlink" title="52 External Commands"></a>52 External Commands</h2><p><code>silent</code>理解<br>就是屏蔽掉输出的报告信息，就是回到命令行界面，然后说press enter to return的那种。</p>
<hr>
<h3 id="system"><a href="#system" class="headerlink" title="system()"></a>system()</h3><p>The system() function takes a command string as a parameter and returns the output of that command as a String.</p>
<p>Read <code>:help bufname</code><br>Read <code>:help bufbyte</code><br>Read <code>:help append()</code><br>Read <code>:help split()</code><br>Read <code>:help :!</code><br>Read <code>:help read</code><br>Read <code>:help read!</code><br>Read <code>:help system()</code><br>Read <code>:help design-not</code><br>Read <code>:help bufwinnr()</code></p>
<hr>
<h2 id="53-Autoloading"><a href="#53-Autoloading" class="headerlink" title="53 Autoloading"></a>53 Autoloading</h2><p>如：</p>
<pre><code class="hljs">call somefile#Hello()
</code></pre>
<p>则Vim会寻找<code>~/.vim/autoload/somefile.vim</code>文件</p>
<p>Read <code>:help autoload</code><br>Read <code>:help silent!</code></p>
<hr>
<h2 id="54-Documentation"><a href="#54-Documentation" class="headerlink" title="54 Documentation"></a>54 Documentation</h2><p>通过filetype可以做很多事，比如<code>:set filetype=help</code>能够使用help文档的高亮。</p>
<p>Read <code>:help help-writing</code><br>Read <code>:help :left</code><br>Read <code>:help :right</code><br>Read <code>:help :center</code></p>
<hr>
<h2 id="55-Distribution"><a href="#55-Distribution" class="headerlink" title="55 Distribution"></a>55 Distribution</h2><hr>
<h2 id="56-What-Now"><a href="#56-What-Now" class="headerlink" title="56 What Now?"></a>56 What Now?</h2><p>Read <code>:help highlight</code><br>Read <code>:help user-commands</code><br>Read <code>:help runtimepath</code><br>Read <code>:help ins-completion</code><br>Read <code>:help omnifunc</code><br>Read <code>:help come-omni</code><br>Read <code>:help quickfix.txt</code><br>Read <code>:help perl-using</code></p>
<p><img src="/media/16565746214097.png" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Vim/" class="category-chain-item">Vim</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Learn Vimscript the Hard Way Notes</div>
      <div>http://example.com/2022/08/25/Learn Vimscript the Hard Way Notes/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月25日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/25/Essential%20C++%20Notes/" title="Essential C++ Notes">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Essential C++ Notes</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/08/25/Wireshark%20%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90/" title="Wireshark 网络分析">
                        <span class="hidden-mobile">Wireshark 网络分析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'zKurisu/comments-utterances');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Jie</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Orkarin</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
