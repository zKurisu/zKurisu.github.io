

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="参考 P1. 最后成果、资源导入、项目设置、角色移动基础将主场景保存在工作目录下的根目录，而不是子目录. 运行游戏之前要选择一个场景，也就是一个 .tscn 文件, scn 应该是 sceen 的缩写. 需要设置更适合像素风的窗口大小，在 Project -&gt; Project Setting -&gt; Display -&gt; Window 下设置. 如: 还需要修改下面的 Stretc">
<meta property="og:type" content="article">
<meta property="og:title" content="Godot-制作-像素游戏-B站教程-Notes">
<meta property="og:url" content="http://example.com/2022/11/13/Godot-%E5%88%B6%E4%BD%9C-%E5%83%8F%E7%B4%A0%E6%B8%B8%E6%88%8F-B%E7%AB%99%E6%95%99%E7%A8%8B-Notes/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="参考 P1. 最后成果、资源导入、项目设置、角色移动基础将主场景保存在工作目录下的根目录，而不是子目录. 运行游戏之前要选择一个场景，也就是一个 .tscn 文件, scn 应该是 sceen 的缩写. 需要设置更适合像素风的窗口大小，在 Project -&gt; Project Setting -&gt; Display -&gt; Window 下设置. 如: 还需要修改下面的 Stretc">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/size_to_suit_pixel.png">
<meta property="og:image" content="http://example.com/img/Ysort_center_of_obj1.png">
<meta property="og:image" content="http://example.com/img/Ysort_center_of_obj2.png">
<meta property="og:image" content="http://example.com/img/reset_to_node2D.png">
<meta property="article:published_time" content="2022-11-13T02:56:59.000Z">
<meta property="article:modified_time" content="2022-11-16T13:00:43.643Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/size_to_suit_pixel.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Godot-制作-像素游戏-B站教程-Notes - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  



  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Jie</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/SteinsGate_all.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Godot-制作-像素游戏-B站教程-Notes"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-11-13 10:56" pubdate>
          2022年11月13日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          67 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Godot-制作-像素游戏-B站教程-Notes</h1>
            
            
              <div class="markdown-body">
                
                <p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV15D4y1U7j5/?spm_id_from=333.880.my_history.page.click&vd_source=bc8ddbb1a08707dc809c3fd9bb85290d">参考</a></p>
<h1 id="P1-最后成果、资源导入、项目设置、角色移动基础"><a href="#P1-最后成果、资源导入、项目设置、角色移动基础" class="headerlink" title="P1. 最后成果、资源导入、项目设置、角色移动基础"></a>P1. 最后成果、资源导入、项目设置、角色移动基础</h1><p>将主场景保存在工作目录下的根目录，而不是子目录.</p>
<p>运行游戏之前要选择一个场景，也就是一个 <code>.tscn</code> 文件, <code>scn</code> 应该是 sceen 的缩写.</p>
<p>需要设置更适合像素风的窗口大小，在 Project -&gt; Project Setting -&gt; Display -&gt; Window 下设置.</p>
<p>如:<br><img src="/../img/size_to_suit_pixel.png" srcset="/img/loading.gif" lazyload></p>
<p>还需要修改下面的 Stretch -&gt; Mode -&gt; 2D</p>
<p>场景是 nodes 的集合. nodes 是挂载在场景之下的. nodes 为树状.</p>
<p>字节点的移动是相对于父节点的.</p>
<p>选择 KinematicBody2D 作为角色的节点. 其为物理碰撞体.</p>
<p>StaticBody 用于游戏中不会移动的物体.</p>
<p>RigidBody 用于使用物理系统运动的物体.</p>
<p>一个显示了很多帧的图片，可以通过调整右侧边栏的 Animation -&gt; Hframes 将其合并. Hframes 中的 H 是 Horizontal.</p>
<p>将脚本创建到与图片同一个文件夹并挂载.</p>
<p>脚本基于哪一个节点创建的就继承哪一个节点的对象, 日:</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">extends</span> <span class="hljs-title class_">KinematicBody2D</span><br></code></pre></td></tr></table></figure>

<p>比如这个脚本挂载到一个 KinematicBody2D node 之下，当场景中的这个节点准备就绪时，ready 函数就运行.</p>
<p><code>_physic_process(delta)</code> 函数在每次物理引擎更新时调用.</p>
<p><code>delta</code> 变量是一个恒定常量，指上一帧花费的时间.</p>
<p>任何不懂的代码可以直接在 Search Help 中搜索.</p>
<p>获取输入使用 <code>Input</code>, 要让人物移动，需要使用 <code>move_and_collide(velocity)</code> 函数.</p>
<p><code>Vector2.ZERO</code> 的含义就是 (0, 0).</p>
<h1 id="P2-关于delta、优化移动"><a href="#P2-关于delta、优化移动" class="headerlink" title="P2. 关于delta、优化移动"></a>P2. 关于delta、优化移动</h1><p><mark>回调函数</mark> , 回调实际上就是重复执行这个函数.</p>
<p><code>_physic_process</code> 中 <code>delta</code> 的值不会变，一直是 1&#x2F;60 (也就是说固定 1&#x2F;60 秒调用一次). 要区分其和 <code>_process</code> 中的 <code>delta</code>.</p>
<ul>
<li><code>_physic_process</code> 和真实时钟同步. 是固定的。</li>
<li><code>_process</code> 和运行的帧率有关</li>
</ul>
<p>速度乘以 <code>delta</code> 的目的是将速度从 x 每帧变成 x 每秒.</p>
<p>原本，一帧处理完之后，物体才会从一个位置移动到另一个位置.</p>
<p>使用 Vector2 对象的成员函数 <code>normalized()</code>, 返回一个 unit vector.</p>
<p>模拟摩擦力需要用到 <code>move_toward()</code> 成员函数，理解为向这个给定的向量靠近, 后面加速率.</p>
<p>设定最大速度用 <code>limit_length()</code> 成员函数:</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">velocity</span> <span class="hljs-operator">=</span> velocity.limit_length(MAX_SPEED * delta)<br></code></pre></td></tr></table></figure>

<h1 id="P3-碰撞、move-and-slide"><a href="#P3-碰撞、move-and-slide" class="headerlink" title="P3. 碰撞、move_and_slide()"></a>P3. 碰撞、move_and_slide()</h1><p>给 KinematicBody2D 添加碰撞. 点击 KinematicBody2D 节点然后添加 CollisionShape2D 节点.</p>
<p>在右侧边栏选择形状 CollisionShape2D -&gt; Shape</p>
<p>选中子节点后按住 Alt 可以只移动子节点.</p>
<p>可以给 StaticBody2D 添加 CollisionPolygon2D, 然后可以自己画出形状. (利用上边栏多出的选项)</p>
<p>画出后 CollisionShape 还不可见，需要在左上角边栏里的 Debug -&gt; Visible Collision Shapes 打开.</p>
<p>使用 <code>move_and_collide()</code> 函数不能让你沿着碰撞体滑动. 可以使用 <code>move_and_slide()</code> 解决，但是需要去除 delta.</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">velocity</span> <span class="hljs-operator">=</span> move_and_slide(velocity)<br></code></pre></td></tr></table></figure>
<p>设置 Window -&gt; Stretch -&gt; Aspect -&gt; keep.</p>
<h1 id="P4-场景、YSort节点"><a href="#P4-场景、YSort节点" class="headerlink" title="P4. 场景、YSort节点"></a>P4. 场景、YSort节点</h1><h2 id="讲解部分"><a href="#讲解部分" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>Godot 可以从已有场景中的节点来创建新的节点. (将一个节点设置为一个单独的 scene, 然后拖拽到新的场景中)</p>
<p>点击一个节点 -&gt; Save Branch as Scene. 先把右侧边栏中的 Transform 下的坐标设置为 (0, 0), 不然你放置的位置是相对原点, 而不是准确的你想要的位置.</p>
<p>将一个物体设置为单独的场景方便管理.</p>
<p>利用 YSort节点 来显示层次关系. 其判断谁在表面谁在下面是通过中心点的 Y 值.</p>
<p><img src="/../img/Ysort_center_of_obj1.png" srcset="/img/loading.gif" lazyload><br><img src="/../img/Ysort_center_of_obj2.png" srcset="/img/loading.gif" lazyload></p>
<p>可以看到 Y 值大的在表面.</p>
<p>点击一个节点，然后 Change Type -&gt; Ysort.</p>
<h2 id="步骤总结"><a href="#步骤总结" class="headerlink" title="步骤总结"></a>步骤总结</h2><p>在一个节点下添加场景:</p>
<ol>
<li>创建一个节点，选中这个节点 </li>
<li>将场景拖拽到地图中，可以看到这个场景挂载到了这个节点下. (一个场景就是节点的集合)</li>
</ol>
<h1 id="P5-角色动画-AnimationPlayer"><a href="#P5-角色动画-AnimationPlayer" class="headerlink" title="P5. 角色动画-AnimationPlayer"></a>P5. 角色动画-AnimationPlayer</h1><h2 id="讲解部分-1"><a href="#讲解部分-1" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>给角色的节点添加 AnimationPlayer 节点.</p>
<p>点击 AnimationPlayer 节点，在下边栏中点击 Animation -&gt; New</p>
<p>Snap 是每一帧的间隔时间, 右上角侧是总时间. 右下角可以调整 timeline.</p>
<p>可以在编辑器中预览动画.</p>
<p>在 Player 脚本内访问 AnimationPlayer 节点.</p>
<p>写在 <code>_ready()</code> 中, 如:</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">var animationPlayer = <span class="hljs-literal">null</span><br><br><span class="hljs-keyword">func</span> <span class="hljs-title function_">_ready</span><span class="hljs-params">()</span>:<br>    animationPlayer = $AnimationPlayer<br></code></pre></td></tr></table></figure>
<p><code>$</code> 是 <code>get_node()</code> 的缩写，可以用来获取树中的节点.</p>
<p>或者写成不需要 <code>_ready()</code> 函数的形式:</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">onready <span class="hljs-keyword">var</span> animationPlayer = <span class="hljs-symbol">$A</span>nimationPlayer<br></code></pre></td></tr></table></figure>

<p>可以查看 AnimationPlayer 的文档如何使用 Animation.</p>
<p>使用 AnimationPlayer 类的成员函数 <code>play()</code>, 其中一个参数是动画名:</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">animationPlayer.<span class="hljs-keyword">play</span>(<span class="hljs-string">&quot;IdleRight&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="步骤总结-1"><a href="#步骤总结-1" class="headerlink" title="步骤总结"></a>步骤总结</h2><h1 id="P6-利用-AnimationTree-设置角色四方向动画"><a href="#P6-利用-AnimationTree-设置角色四方向动画" class="headerlink" title="P6. 利用 AnimationTree 设置角色四方向动画"></a>P6. 利用 AnimationTree 设置角色四方向动画</h1><p>在 Play 下添加一个节点 AnimationTree, 需要现在右侧边栏中 AnimationTree -&gt; Anim Player 中给它分配一个 AnimationPlayer.</p>
<p>AnimationTree 有很多中结构，需要在右侧边栏中选择 AnimationTree -&gt; Tree Root, 这里选择的是 AnimationNodeStateMachine.</p>
<p>同样要勾选 Animation -&gt; Active -&gt; on, 来 activate 这个 tree.</p>
<p>在下边栏中右键可创建动画.</p>
<p>添加 Blendspace2D, 这个节点的含义大概是将多个动画放在一起，通过一个二维向量来判断播放哪一个. 注意这里的坐标系和二维游戏坐标系不同. 切换到虚线模式.</p>
<p>可以添加几个 Blendspace2D 动画的转换. 即什么条件下从一个动画切换到下一个动画.</p>
<p>如:</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">animationTree.<span class="hljs-built_in">set</span>(<span class="hljs-string">&quot;parameters/Idel/blend_position&quot;</span>, input_vector)<br></code></pre></td></tr></table></figure>
<p>这个的含义大概是设置 “parameters&#x2F;Idel&#x2F;blend_position” 这个动画，然后通过 <code>Input_vector</code> 这个向量来设置 前者的值.</p>
<p><code>set</code> 第一个参数是 AnimationTree 右边栏的参数.</p>
<h1 id="P7-草地背景和Auto-Tile"><a href="#P7-草地背景和Auto-Tile" class="headerlink" title="P7. 草地背景和Auto Tile"></a>P7. 草地背景和Auto Tile</h1><p>重新设置一下.</p>
<p><img src="/../img/reset_to_node2D.png" srcset="/img/loading.gif" lazyload></p>
<p>第一个方法设置背景:</p>
<p>设置一个 regon, 点击图片 Import -&gt; Flags -&gt; Repeat -&gt; Enabled -&gt; reimport, 之后先在右边栏 Regon -&gt; Enabled -&gt; on, 然后在下边栏 -&gt; Textureregion</p>
<p>第二个方法，添加一个 TextureRect 节点. 添加图片后，在右边栏设置 Stretch Mode -&gt; Tile, 就会自动平铺.</p>
<p>关于 Tile 的部分，添加一个 TileMap 节点, 先设置一部分，在右边栏 Cell -&gt; Size 两个 16, 然后 TileMap -&gt; Tile Set -&gt; TileSet, 点击这个 TileSet 可以看到 Resource 的参数.</p>
<p>在 Tile 面板中一般添加 Autotile</p>
<p>Bitmask 的作用不太清楚.</p>
<p>Shift + F12 可以将 TileMap 全屏。</p>
<h1 id="P8-Autotile碰撞"><a href="#P8-Autotile碰撞" class="headerlink" title="P8. Autotile碰撞"></a>P8. Autotile碰撞</h1><p>给一些 tile 增加碰撞的特性.</p>
<h1 id="P9-攻击动画和State-Machine"><a href="#P9-攻击动画和State-Machine" class="headerlink" title="P9. 攻击动画和State Machine"></a>P9. 攻击动画和State Machine</h1><h2 id="讲解部分-2"><a href="#讲解部分-2" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>enum 是从 0 开始的.</p>
<p>设置键位: Project -&gt; Project Settings -&gt; Input_map, 然后就可以设置, 添加.</p>
<p>同样添加动画.</p>
<p>在动画的最后一帧添加一个 track: Add Track -&gt; Call Method Track, 这一帧用来调用一个函数.</p>
<h2 id="总结步骤"><a href="#总结步骤" class="headerlink" title="总结步骤"></a>总结步骤</h2><p>添加并引用动画的步骤:</p>
<ol>
<li>创建一个节点, 添加 Sprite 节点 (或 AnimatedSprite 节点) 并添加含有多帧画面的图像</li>
<li>若是 Sprite 节点，则再添加一个 Animation 节点如 AnimationPlayer, AnimationTree </li>
<li>设置动画</li>
<li>在挂载的脚本中引用动画，先用 <code>onready var animatedSprite = $AnimatedSprite</code> 这种形式来获取动画节点 (一个对象),</li>
</ol>
<h1 id="P10-信号、在代码中引用场景"><a href="#P10-信号、在代码中引用场景" class="headerlink" title="P10. 信号、在代码中引用场景"></a>P10. 信号、在代码中引用场景</h1><h2 id="讲解部分-3"><a href="#讲解部分-3" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>ysort 是用父节点来排序的.</p>
<p><code>_process(delta)</code> 和 <code>_physic_process(delta)</code> 的区别，前者的 <code>delta</code> 不是常量，后者的 <code>delta</code> 是常量.</p>
<p><code>queue_free()</code> 函数，将节点添加到一个会被 free 的队列中. 注意和 <code>free()</code> 的区别，前者不是立即清除.</p>
<p>简单的动画使用 <code>AnimatedSprite</code> 节点.</p>
<p>在 <code>AnimatedSprite</code> 节点中的右边栏，切换到 Node 可以看到 Signals</p>
<p>信号可以在某个事件发生时触发, 当一个信号触发时 (连接到一个函数就是当这个函数运行时.)</p>
<p><code>load()</code> 函数，加载一个场景.</p>
<p><code>instance()</code> 函数，用场景创建一个节点.</p>
<p>用 <code>get_tree().current_scene</code> 来获取当前场景的根节点.</p>
<p>节点用 <code>add_child()</code> 成员函数可以添加子节点. 这个子节点的位置默认是 (0, 0), 因此需要添加位置. 如:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">grassEffect.global_position</span> = global_position<br></code></pre></td></tr></table></figure>
<p><code>global_position</code> 应该是预处理的变量. 你把代码挂载到哪一个节点，这个位置就是哪一个节点的位置.</p>
<p>Remote 是当前游戏运行的即时场景.</p>
<h2 id="总结步骤-1"><a href="#总结步骤-1" class="headerlink" title="总结步骤"></a>总结步骤</h2><p>动画播放后消失:</p>
<ol>
<li>给节点挂载脚本</li>
<li>添加信号 animation_finished</li>
<li>在这个信号提供的函数下写动画播放完毕后要做的事</li>
</ol>
<p>在一个节点中引用场景的步骤:</p>
<ol>
<li>选择一个节点的脚本 (你想把场景加载到这个节点下)，加载场景，储存在变量里</li>
<li>引用该场景，储存在变量里</li>
<li>把引用添加到任意一个节点下面，作为它的子节点</li>
<li>设置子节点的位置</li>
</ol>
<h1 id="P11-近战攻击的Hurtboxes（伤害检测框）"><a href="#P11-近战攻击的Hurtboxes（伤害检测框）" class="headerlink" title="P11. 近战攻击的Hurtboxes（伤害检测框）"></a>P11. 近战攻击的Hurtboxes（伤害检测框）</h1><h2 id="讲解部分-4"><a href="#讲解部分-4" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>新建两个场景，使用 Area2D 节点. 其有与位置相关的信号.</p>
<p>分为 Hurtbox 和 Hitbox.</p>
<p>给节点添加 CollisionShape2D 子节点.</p>
<p>一个 Area2D 节点必须要有 CollisionShape2D 节点. 可以用来检测碰撞，检测玩家进入区域等 (查看右边栏的 Signals).</p>
<p>把 Area2D 场景添加到一个节点上.</p>
<p>Hurtbox 加在受到攻击的物体上，Hitbox 加在发出攻击的物体上.</p>
<p>将 Hitbox 绑定到击打动画上, 创建一个 Position2D 节点 (其实际上和 Node2D 差不多, 只不过用的是十字坐标, Node2D 也可以添加 key).</p>
<p>需要确定在某一帧激活 Hitbox</p>
<p>Collision -&gt; Layer 和 Mask 可以在 Project Setting -&gt; Layer Names -&gt; 2d Physics 中命名</p>
<p>注意 Layer 和 Mask 的作用，Layer 是设置当前节点所在那一层, Mask 是设置当前节点会和那一层发生关系, 设置了的则会被处于 Layer 的扫描到 (为什么叫 Mask, 不清楚)</p>
<h2 id="步骤总结-2"><a href="#步骤总结-2" class="headerlink" title="步骤总结"></a>步骤总结</h2><p>思路: 检测碰撞 -&gt; 在指定事件发生时触发</p>
<h1 id="P13-蝙蝠小怪和击退效果"><a href="#P13-蝙蝠小怪和击退效果" class="headerlink" title="P13. 蝙蝠小怪和击退效果"></a>P13. 蝙蝠小怪和击退效果</h1><h2 id="讲解部分-5"><a href="#讲解部分-5" class="headerlink" title="讲解部分"></a>讲解部分</h2><p>击退效果的思路，在遭遇伤害时给一个与攻击方向相同的初速度，然后通过 <code>move_toward()</code> 函数让这个初速度变为零.</p>
<p>用 <code>onready var swordHitbox = $SwordHisbox</code> 获取的节点，可以访问其中挂载脚本的变量如:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">swordHitbox.knockback_vector</span> = Vector2.ZERO<br></code></pre></td></tr></table></figure>

<p>关于这两行的理解:</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">func _on_Area2D_area_entered(<span class="hljs-built_in">area</span>):<br>	knockback = <span class="hljs-built_in">area</span>.knockback_vector * <span class="hljs-number">200</span><br></code></pre></td></tr></table></figure>
<p>这里的参数 <code>area</code> 是进入这个 area 的 Area2D 对象. <code>knockback_vector</code> 是这个对象挂载脚本里的变量.</p>
<p>一个节点，挂载了脚本之后，似乎脚本中的变量可以被当作成员变量使用.</p>
<h1 id="P14-敌人属性、输出变量、Setget、代码结构"><a href="#P14-敌人属性、输出变量、Setget、代码结构" class="headerlink" title="P14. 敌人属性、输出变量、Setget、代码结构"></a>P14. 敌人属性、输出变量、Setget、代码结构</h1><p>创建通用的属性. 就是把一部分节点保存为场景，在其他场景中引用.</p>
<p><code>export</code> 一个变量，就是将其变为可以在编辑器中直接修改</p>
<p>用 <code>export</code> 带固定属性的写法:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">export</span><span class="hljs-params">(int)</span></span> <span class="hljs-selector-tag">var</span> test = <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p>注意, 在编辑器中获取的数值，是在 ready 的时候更新.</p>
<p>创建信号, 如:</p>
<figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs qml"><span class="hljs-keyword">signal</span><span class="hljs-string"> no_health</span><br></code></pre></td></tr></table></figure>

<p>发送信号示例:</p>
<figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">func</span> <span class="hljs-function"><span class="hljs-title">_process</span>():</span><br><span class="hljs-function">    <span class="hljs-variable"><span class="hljs-keyword">if</span></span> <span class="hljs-variable">health</span> &lt;= <span class="hljs-number">0</span>:</span><br><span class="hljs-function">        <span class="hljs-title">emit_signal</span>(<span class="hljs-string">&quot;no_health&quot;</span>)</span><br></code></pre></td></tr></table></figure>

<p>在一个值改变是调用一个函数, 使用 <code>setget</code>:</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gml">onready <span class="hljs-keyword">var</span> <span class="hljs-variable language_">health</span> = max_health setget set_health<br><br>func set_health(value):<br>    <span class="hljs-variable language_">health</span> = value<br></code></pre></td></tr></table></figure>
<p>这里，每当 <code>health</code> 的值发生改变，就会调用 <code>set_health()</code> 函数. </p>
<p>注意 “向下调用，向上信号”, 意思是，节点树的上层要传递信息给下层，则使用函数传递，下层向上层传递信息，则使用信号.</p>
<p>一个脚本可以继承另一个脚本，如:</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">expands</span> <span class="hljs-string">&quot;res://Overlap/Hitbox.gd&quot;</span><br></code></pre></td></tr></table></figure>

<h1 id="P15-小怪死亡效果、Bug修复"><a href="#P15-小怪死亡效果、Bug修复" class="headerlink" title="P15. 小怪死亡效果、Bug修复"></a>P15. 小怪死亡效果、Bug修复</h1><p>设置所有初始动画的 Blend Position 相同.</p>
<p><code>preload()</code> 函数的使用.</p>
<h1 id="P16-蝙蝠基础AI"><a href="#P16-蝙蝠基础AI" class="headerlink" title="P16. 蝙蝠基础AI"></a>P16. 蝙蝠基础AI</h1><p>添加检测玩家的区域. 添加 Area2D 节点.</p>
<p>添加 body_entered 和 body_exited 信号.</p>
<p>其信号函数中:</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-keyword">func</span> <span class="hljs-title function_">_on_PlayerDetectZone_body_entered</span><span class="hljs-params">(body)</span>:<br></code></pre></td></tr></table></figure>
<p>的 <code>body</code> 应该代表一个场景对象.</p>
<p>使图片水平反转，需要使用 <code>flip_h</code> 成员函数.</p>
<h1 id="P17-玩家属性、小怪攻击"><a href="#P17-玩家属性、小怪攻击" class="headerlink" title="P17. 玩家属性、小怪攻击"></a>P17. 玩家属性、小怪攻击</h1><p>思路，通过区域检测来判断攻击.</p>
<p><code>connect()</code> 函数的用法: 信号，对象，对象中的函数</p>
<p>Timer 节点. 有 <code>start()</code> 成员函数，参数是一段时间. 其结束时会和 time_out 信号发生作用.</p>
<p>调整 Monitorable 属性 (或 Monitoring)，达到重新发送信号的要求.</p>
<p>有些属性不能在 <code>_physic_process()</code> 运行中直接修改, 需要用 <code>set_deferred()</code> 函数，第一个参数是属性，第二个是值.</p>
<p>自动加载一个场景: Project -&gt; Project Settings -&gt; Autoload -&gt; 选择一个文件 -&gt; add</p>
<h1 id="P18-玩家生命值UI"><a href="#P18-玩家生命值UI" class="headerlink" title="P18. 玩家生命值UI"></a>P18. 玩家生命值UI</h1><p>给 world 场景添加一个新的节点.</p>
<p>Godot 里大部分 Control 节点都和 UI 有关系. 其 position 和 普通的不同. 其很多属性也和 node2D 不同.</p>
<p>有锚点属性 Anchor, 其默认位于原点. margin 表示 label 的大小.</p>
<p>创建一个 Control 节点，再创建一个 label 子节点. 将其作为场景保存.</p>
<p>关于 <code>clamp()</code> 函数，其将一个数截取. 三个参数，输入，最小，最大.</p>
<p>使用 <code>setget</code> 的好处是，当一个变量改变时，会触发一个函数.</p>
<p>使用 TectureRect 节点, 设置在拉伸时自动重复: 右侧边栏 -&gt; TectureRect -&gt; Stretch Mode -&gt; Tile</p>
<p>通过长度来判断心的个数.</p>
<p>设置生命值不超过最大值可以用 <code>min()</code> 函数, 其返回两个参数中的最小值.</p>
<p>设置 TectureRect 节点右边栏 Expand -&gt; on, 就可以把 Rect -&gt; Size 设置为 0.</p>
<p>定义的信号后面可以加上参数，可以在 <code>emit_signal()</code> 中发送:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">signal <span class="hljs-built_in">test</span>(value)<br><span class="hljs-function"><span class="hljs-title">emit_signal</span><span class="hljs-params">(<span class="hljs-string">&quot;test&quot;</span>, value1)</span></span><br></code></pre></td></tr></table></figure>

<p>添加一个静止不动的物体一般使用 StaticBody2D.</p>
<h1 id="P19-小怪软碰撞、性能监测"><a href="#P19-小怪软碰撞、性能监测" class="headerlink" title="P19. 小怪软碰撞、性能监测"></a>P19. 小怪软碰撞、性能监测</h1><p>创建软碰撞，先创建一个 Area2D 节点，添加一个 CollisionShape2D 子节点.</p>
<p>Area2D 的成员函数 <code>get_overlapping_areas()</code>, 判断是否重叠. 实现软碰撞的思路是让重叠的部分在检测到重叠时移动.</p>
<p>适当增加判断性函数如: <code>is_colliding()</code></p>
<h1 id="P20-镜头"><a href="#P20-镜头" class="headerlink" title="P20. 镜头"></a>P20. 镜头</h1><p>添加一个跟随角色的镜头.</p>
<p>在 Player 节点下添加一个 Camera2D 节点. 为了使用这个节点，在右侧边栏 Camera2D -&gt; Current -&gt; on</p>
<p>为了让生命值跟随镜头，添加一个 Canvaslayer 节点，这个节点会跟随镜头, 然后将生命值设置为其子节点. 开启右边栏的 Smoothing -&gt; Enabled -&gt; on 会更好.</p>
<p>解决角色死亡后镜头跳转问题. 将 Camera2D 节点移到外面，在 Player 下添加 RemoteTransform2D 节点，这个节点的作用是，你给它一个路径，就可以让指定路径的节点跟随这个节点. 由于这个 RemoteTransform2D 节点是跟随 Player 的，让 Camera2D 节点跟随这个节点也就可以跟随 Player.</p>
<p>可以调整 Camera 的大小.</p>
<h1 id="P21-蝙蝠游荡状态"><a href="#P21-蝙蝠游荡状态" class="headerlink" title="P21. 蝙蝠游荡状态"></a>P21. 蝙蝠游荡状态</h1><p>添加一个 Node2D 节点作为控制节点，因为需要这个节点的位置来作为游荡的原始位置.</p>
<p>给这个节点添加一个 Timer 子节点.</p>
<p>可以设置 Timer 自动开始，且运行一次. 右边栏 One Shot -&gt; on, Autostart -&gt; on</p>
<p><code>rand_range()</code> 函数可以返回范围内的随机值, 如: <code>rand_range(-32, 32)</code></p>
<p>数组的 <code>shuffle()</code> 函数，随机取出一个值. <code>pop_front()</code> 函数，选取数组的第一个值.</p>
<p>向 Player 移动:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">var direction = global_position.direction<span class="hljs-constructor">_to(<span class="hljs-params">player</span>.<span class="hljs-params">global_position</span>)</span><br></code></pre></td></tr></table></figure>
<p><code>direction_to()</code> 函数，直译就是朝向，也就是设置当前位置指向 player 位置的方向向量.</p>
<h1 id="P22-音效、闪烁特效（着色器）"><a href="#P22-音效、闪烁特效（着色器）" class="headerlink" title="P22. 音效、闪烁特效（着色器）"></a>P22. 音效、闪烁特效（着色器）</h1><p>在 Player 节点下添加 AudioStreamPlayer 子节点 (其和 AudioStreamPlayer2D 的区别是，后者在靠近时音量会改变).</p>
<p>在 AnimationPlayer 中的下边栏 Animation 中 Add Track 可以添加 AudioStreamPlayer, 用于分配音频.</p>
<p>没有在同一个节点树中的节点，可以通过 <code>preload()</code> 来加载. 但使用是需要先用 <code>instance()</code> 创建一个对象，然后通过 <code>get_tree().current_scene.add_child()</code> 来将这个场景添加到树中.</p>
<p>闪烁特效同样添加 AnimationPlayer 子节点.</p>
<p>使用 Godot 的 Shader, 点击 Sprite, 然后右边栏下方 Material -&gt; Material -&gt; New ShaderMaterial -&gt; Shader -&gt; NewShader, shader 同样用代码控制，保存以 <code>.shaderl</code> 为后缀的文件.</p>
<p>Godot 的 shader 语言，有分号. 和 C++ 类似.</p>
<p>可操作每个像素的颜色.</p>
<p>在 Shader 中，应该避免使用 <code>if</code> 语句.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Godot-制作-像素游戏-B站教程-Notes</div>
      <div>http://example.com/2022/11/13/Godot-制作-像素游戏-B站教程-Notes/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年11月13日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/11/18/Godot-%E5%AE%98%E6%96%B9-2D-%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E9%A1%B9%E7%9B%AE%E7%A4%BA%E4%BE%8B/" title="Godot-官方-2D-游戏制作项目示例">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Godot-官方-2D-游戏制作项目示例</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/11/12/%E8%AE%BE%E7%BD%AE-git-%E7%9A%84%E4%BB%A3%E7%90%86/" title="设置-git-的代理">
                        <span class="hidden-mobile">设置-git-的代理</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'zKurisu/comments-utterances');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
